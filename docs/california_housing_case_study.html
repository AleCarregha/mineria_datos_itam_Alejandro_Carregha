<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Caso de Estudio: Predicci√≥n de Precios de Vivienda en California ‚Äì Miner√≠a de Datos</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./regresion_lineal.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-2fef5ea3f8957b3e4ecc936fc74692ca.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-2453fe3dad938b07a2e5eff64ea8abce.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-c1367505ed6638c8d4e510e1459ae853.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-2453fe3dad938b07a2e5eff64ea8abce.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la b√∫squeda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Buscar"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<meta property="og:title" content="Caso de Estudio: Predicci√≥n de Precios de Vivienda en California ‚Äì Miner√≠a de Datos">
<meta property="og:description" content="">
<meta property="og:image" content="california_housing_case_study_files/figure-html/cell-9-output-1.png">
<meta property="og:site_name" content="Miner√≠a de Datos">
</head>

<body class="nav-sidebar floating quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./introduccion.html">Ejemplos</a></li><li class="breadcrumb-item"><a href="./california_housing_case_study.html"><span class="chapter-title">Caso de Estudio: Predicci√≥n de Precios de Vivienda en California</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Buscar" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Miner√≠a de Datos</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Alternar modo oscuro"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Buscar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Temario</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-requerimientos-computacion.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Requerimientos computacionales</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-introduccion.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Introducci√≥n</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-principios.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Principios de aprendizaje supervisado</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Regresion lineal</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Alternar secci√≥n">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-regresion_lineal.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Regresi√≥n lineal</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./violaciones_supuestos_regresion.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Violaciones de los Supuestos de Regresi√≥n Lineal</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./analisis_advertising_dataset.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">An√°lisis de Regresi√≥n Lineal con el Dataset Advertising</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ejercicio_wine_quality.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Ejercicio: An√°lisis de Regresi√≥n con el Dataset Wine Quality</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-clasificacion.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Clasificaci√≥n</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-arboles.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">√Årboles de Decisi√≥n</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-boosting.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">M√©todos de Boosting</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Referencias</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Ejemplos</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Alternar secci√≥n">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introduccion.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Introducci√≥n a Python para Miner√≠a de Datos</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./regresion_lineal.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Descenso en gradiente con regresi√≥n lineal</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./california_housing_case_study.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">Caso de Estudio: Predicci√≥n de Precios de Vivienda en California</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Tabla de contenidos</h2>
   
  <ul>
  <li><a href="#introducci√≥n-al-problema-de-negocio" id="toc-introducci√≥n-al-problema-de-negocio" class="nav-link active" data-scroll-target="#introducci√≥n-al-problema-de-negocio">Introducci√≥n al Problema de Negocio</a>
  <ul class="collapse">
  <li><a href="#contexto-del-negocio" id="toc-contexto-del-negocio" class="nav-link" data-scroll-target="#contexto-del-negocio">Contexto del Negocio</a></li>
  <li><a href="#stakeholders-interesados" id="toc-stakeholders-interesados" class="nav-link" data-scroll-target="#stakeholders-interesados">Stakeholders (Interesados)</a></li>
  <li><a href="#pregunta-de-negocio" id="toc-pregunta-de-negocio" class="nav-link" data-scroll-target="#pregunta-de-negocio">Pregunta de Negocio</a></li>
  <li><a href="#tipo-de-tarea" id="toc-tipo-de-tarea" class="nav-link" data-scroll-target="#tipo-de-tarea">Tipo de Tarea</a></li>
  <li><a href="#descripci√≥n-del-dataset" id="toc-descripci√≥n-del-dataset" class="nav-link" data-scroll-target="#descripci√≥n-del-dataset">Descripci√≥n del Dataset</a></li>
  <li><a href="#criterios-de-√©xito" id="toc-criterios-de-√©xito" class="nav-link" data-scroll-target="#criterios-de-√©xito">Criterios de √âxito</a></li>
  </ul></li>
  <li><a href="#importar-librer√≠as-y-configuraci√≥n-inicial" id="toc-importar-librer√≠as-y-configuraci√≥n-inicial" class="nav-link" data-scroll-target="#importar-librer√≠as-y-configuraci√≥n-inicial">1. Importar Librer√≠as y Configuraci√≥n Inicial</a></li>
  <li><a href="#carga-y-exploraci√≥n-inicial-de-datos" id="toc-carga-y-exploraci√≥n-inicial-de-datos" class="nav-link" data-scroll-target="#carga-y-exploraci√≥n-inicial-de-datos">2. Carga y Exploraci√≥n Inicial de Datos</a></li>
  <li><a href="#an√°lisis-exploratorio-de-datos-eda" id="toc-an√°lisis-exploratorio-de-datos-eda" class="nav-link" data-scroll-target="#an√°lisis-exploratorio-de-datos-eda">3. An√°lisis Exploratorio de Datos (EDA)</a>
  <ul class="collapse">
  <li><a href="#an√°lisis-de-la-variable-objetivo" id="toc-an√°lisis-de-la-variable-objetivo" class="nav-link" data-scroll-target="#an√°lisis-de-la-variable-objetivo">3.1 An√°lisis de la Variable Objetivo</a></li>
  <li><a href="#distribuci√≥n-de-caracter√≠sticas-predictoras" id="toc-distribuci√≥n-de-caracter√≠sticas-predictoras" class="nav-link" data-scroll-target="#distribuci√≥n-de-caracter√≠sticas-predictoras">3.2 Distribuci√≥n de Caracter√≠sticas Predictoras</a></li>
  <li><a href="#an√°lisis-de-correlaciones" id="toc-an√°lisis-de-correlaciones" class="nav-link" data-scroll-target="#an√°lisis-de-correlaciones">3.3 An√°lisis de Correlaciones</a></li>
  <li><a href="#relaciones-bivariadas-con-la-variable-objetivo" id="toc-relaciones-bivariadas-con-la-variable-objetivo" class="nav-link" data-scroll-target="#relaciones-bivariadas-con-la-variable-objetivo">3.4 Relaciones Bivariadas con la Variable Objetivo</a></li>
  </ul></li>
  <li><a href="#an√°lisis-geogr√°fico" id="toc-an√°lisis-geogr√°fico" class="nav-link" data-scroll-target="#an√°lisis-geogr√°fico">4. An√°lisis Geogr√°fico</a></li>
  <li><a href="#preparaci√≥n-de-datos" id="toc-preparaci√≥n-de-datos" class="nav-link" data-scroll-target="#preparaci√≥n-de-datos">5. Preparaci√≥n de Datos</a>
  <ul class="collapse">
  <li><a href="#detecci√≥n-y-manejo-de-outliers" id="toc-detecci√≥n-y-manejo-de-outliers" class="nav-link" data-scroll-target="#detecci√≥n-y-manejo-de-outliers">5.1 Detecci√≥n y Manejo de Outliers</a></li>
  <li><a href="#divisi√≥n-traintest-y-separaci√≥n-xy" id="toc-divisi√≥n-traintest-y-separaci√≥n-xy" class="nav-link" data-scroll-target="#divisi√≥n-traintest-y-separaci√≥n-xy">5.2 Divisi√≥n Train/Test y Separaci√≥n X/y</a></li>
  <li><a href="#escalado-de-caracter√≠sticas" id="toc-escalado-de-caracter√≠sticas" class="nav-link" data-scroll-target="#escalado-de-caracter√≠sticas">5.3 Escalado de Caracter√≠sticas</a></li>
  <li><a href="#modelo-baseline-predictor-de-la-media" id="toc-modelo-baseline-predictor-de-la-media" class="nav-link" data-scroll-target="#modelo-baseline-predictor-de-la-media">5.4 Modelo Baseline (Predictor de la Media)</a></li>
  </ul></li>
  <li><a href="#modelado-1-regresi√≥n-lineal-y-elastic-net" id="toc-modelado-1-regresi√≥n-lineal-y-elastic-net" class="nav-link" data-scroll-target="#modelado-1-regresi√≥n-lineal-y-elastic-net">6. Modelado 1: Regresi√≥n Lineal y Elastic Net</a>
  <ul class="collapse">
  <li><a href="#regresi√≥n-lineal-ordinary-least-squares" id="toc-regresi√≥n-lineal-ordinary-least-squares" class="nav-link" data-scroll-target="#regresi√≥n-lineal-ordinary-least-squares">6.1 Regresi√≥n Lineal (Ordinary Least Squares)</a></li>
  <li><a href="#elastic-net-con-validaci√≥n-cruzada" id="toc-elastic-net-con-validaci√≥n-cruzada" class="nav-link" data-scroll-target="#elastic-net-con-validaci√≥n-cruzada">6.2 Elastic Net con Validaci√≥n Cruzada</a></li>
  </ul></li>
  <li><a href="#modelado-2-√°rbol-de-decisi√≥n" id="toc-modelado-2-√°rbol-de-decisi√≥n" class="nav-link" data-scroll-target="#modelado-2-√°rbol-de-decisi√≥n">7. Modelado 2: √Årbol de Decisi√≥n</a></li>
  <li><a href="#modelado-3-random-forest" id="toc-modelado-3-random-forest" class="nav-link" data-scroll-target="#modelado-3-random-forest">8. Modelado 3: Random Forest</a></li>
  <li><a href="#modelado-4-xgboost" id="toc-modelado-4-xgboost" class="nav-link" data-scroll-target="#modelado-4-xgboost">9. Modelado 4: XGBoost</a></li>
  <li><a href="#comparaci√≥n-final-de-modelos-y-conclusiones" id="toc-comparaci√≥n-final-de-modelos-y-conclusiones" class="nav-link" data-scroll-target="#comparaci√≥n-final-de-modelos-y-conclusiones">10. Comparaci√≥n Final de Modelos y Conclusiones</a></li>
  <li><a href="#conclusiones-y-recomendaciones" id="toc-conclusiones-y-recomendaciones" class="nav-link" data-scroll-target="#conclusiones-y-recomendaciones">Conclusiones y Recomendaciones</a>
  <ul class="collapse">
  <li><a href="#evaluaci√≥n-de-criterios-de-√©xito" id="toc-evaluaci√≥n-de-criterios-de-√©xito" class="nav-link" data-scroll-target="#evaluaci√≥n-de-criterios-de-√©xito">üéØ Evaluaci√≥n de Criterios de √âxito</a></li>
  <li><a href="#insights-clave-del-an√°lisis" id="toc-insights-clave-del-an√°lisis" class="nav-link" data-scroll-target="#insights-clave-del-an√°lisis">üìù Insights Clave del An√°lisis</a></li>
  <li><a href="#recomendaciones-de-negocio" id="toc-recomendaciones-de-negocio" class="nav-link" data-scroll-target="#recomendaciones-de-negocio">üíº Recomendaciones de Negocio</a></li>
  <li><a href="#factores-clave-del-precio-seg√∫n-feature-importance-de-xgboost" id="toc-factores-clave-del-precio-seg√∫n-feature-importance-de-xgboost" class="nav-link" data-scroll-target="#factores-clave-del-precio-seg√∫n-feature-importance-de-xgboost">üîç Factores Clave del Precio (Seg√∫n Feature Importance de XGBoost)</a></li>
  <li><a href="#cumplimiento-de-criterios-de-√©xito" id="toc-cumplimiento-de-criterios-de-√©xito" class="nav-link" data-scroll-target="#cumplimiento-de-criterios-de-√©xito">üìä Cumplimiento de Criterios de √âxito</a></li>
  <li><a href="#limitaciones-y-consideraciones" id="toc-limitaciones-y-consideraciones" class="nav-link" data-scroll-target="#limitaciones-y-consideraciones">‚ö†Ô∏è Limitaciones y Consideraciones</a></li>
  <li><a href="#pr√≥ximos-pasos-para-puesta-en-producci√≥n" id="toc-pr√≥ximos-pasos-para-puesta-en-producci√≥n" class="nav-link" data-scroll-target="#pr√≥ximos-pasos-para-puesta-en-producci√≥n">üöÄ Pr√≥ximos Pasos para Puesta en Producci√≥n</a></li>
  <li><a href="#valor-de-negocio-esperado" id="toc-valor-de-negocio-esperado" class="nav-link" data-scroll-target="#valor-de-negocio-esperado">üí∞ Valor de Negocio Esperado</a></li>
  </ul></li>
  <li><a href="#resumen-para-estudiantes" id="toc-resumen-para-estudiantes" class="nav-link" data-scroll-target="#resumen-para-estudiantes">üéì Resumen para Estudiantes</a>
  <ul class="collapse">
  <li><a href="#lo-que-aprendimos-en-este-caso-de-estudio" id="toc-lo-que-aprendimos-en-este-caso-de-estudio" class="nav-link" data-scroll-target="#lo-que-aprendimos-en-este-caso-de-estudio">Lo que aprendimos en este caso de estudio:</a></li>
  <li><a href="#resultados-concretos-obtenidos" id="toc-resultados-concretos-obtenidos" class="nav-link" data-scroll-target="#resultados-concretos-obtenidos">üìà Resultados Concretos Obtenidos</a></li>
  <li><a href="#reflexi√≥n-final" id="toc-reflexi√≥n-final" class="nav-link" data-scroll-target="#reflexi√≥n-final">üí° Reflexi√≥n Final</a></li>
  <li><a href="#lecciones-pr√°cticas-para-futuros-proyectos" id="toc-lecciones-pr√°cticas-para-futuros-proyectos" class="nav-link" data-scroll-target="#lecciones-pr√°cticas-para-futuros-proyectos">üéØ Lecciones Pr√°cticas para Futuros Proyectos</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./introduccion.html">Ejemplos</a></li><li class="breadcrumb-item"><a href="./california_housing_case_study.html"><span class="chapter-title">Caso de Estudio: Predicci√≥n de Precios de Vivienda en California</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-title">Caso de Estudio: Predicci√≥n de Precios de Vivienda en California</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="introducci√≥n-al-problema-de-negocio" class="level2">
<h2 class="anchored" data-anchor-id="introducci√≥n-al-problema-de-negocio">Introducci√≥n al Problema de Negocio</h2>
<p>En este caso de estudio completo, abordaremos un problema real de predicci√≥n de precios de vivienda utilizando el dataset <strong>California Housing</strong> del censo de California de 1990. Este ejemplo integra todos los conceptos vistos en el curso: desde el an√°lisis exploratorio hasta la comparaci√≥n de m√∫ltiples algoritmos de aprendizaje autom√°tico.</p>
<section id="contexto-del-negocio" class="level3">
<h3 class="anchored" data-anchor-id="contexto-del-negocio">Contexto del Negocio</h3>
<p>Imagina que trabajas para una empresa de bienes ra√≠ces en California. Tu equipo necesita una herramienta que permita <strong>estimar el valor medio de las viviendas</strong> en diferentes distritos de California bas√°ndose en caracter√≠sticas demogr√°ficas y geogr√°ficas.</p>
</section>
<section id="stakeholders-interesados" class="level3">
<h3 class="anchored" data-anchor-id="stakeholders-interesados">Stakeholders (Interesados)</h3>
<ul>
<li><strong>Agentes inmobiliarios</strong>: Necesitan gu√≠a para fijar precios competitivos</li>
<li><strong>Inversionistas</strong>: Buscan identificar √°reas con potencial de inversi√≥n</li>
<li><strong>Planificadores urbanos</strong>: Quieren entender din√°micas del mercado inmobiliario</li>
<li><strong>Tasadores</strong>: Requieren apoyo para valuaci√≥n de propiedades</li>
</ul>
</section>
<section id="pregunta-de-negocio" class="level3">
<h3 class="anchored" data-anchor-id="pregunta-de-negocio">Pregunta de Negocio</h3>
<p><strong>¬øPodemos predecir el valor medio de las viviendas en un distrito de California con suficiente precisi√≥n para ser √∫til en decisiones de inversi√≥n y fijaci√≥n de precios?</strong></p>
</section>
<section id="tipo-de-tarea" class="level3">
<h3 class="anchored" data-anchor-id="tipo-de-tarea">Tipo de Tarea</h3>
<p><strong>Regresi√≥n</strong>: Estamos prediciendo una variable continua (precio de vivienda) a partir de m√∫ltiples caracter√≠sticas.</p>
</section>
<section id="descripci√≥n-del-dataset" class="level3">
<h3 class="anchored" data-anchor-id="descripci√≥n-del-dataset">Descripci√≥n del Dataset</h3>
<p>El dataset contiene informaci√≥n de <strong>20,640 distritos</strong> (block groups) del censo de California.</p>
<p><strong>Variables predictoras (8 caracter√≠sticas):</strong></p>
<ul>
<li><strong>MedInc</strong>: Ingreso medio del distrito (en $10,000 USD)</li>
<li><strong>HouseAge</strong>: Edad media de las viviendas (a√±os)</li>
<li><strong>AveRooms</strong>: Promedio de habitaciones por vivienda</li>
<li><strong>AveBedrms</strong>: Promedio de dormitorios por vivienda</li>
<li><strong>Population</strong>: Poblaci√≥n del distrito</li>
<li><strong>AveOccup</strong>: Promedio de ocupantes por vivienda</li>
<li><strong>Latitude</strong>: Latitud del distrito</li>
<li><strong>Longitude</strong>: Longitud del distrito</li>
</ul>
<p><strong>Variable objetivo:</strong></p>
<ul>
<li><strong>MedHouseVal</strong>: Valor medio de las viviendas (en $100,000 USD)</li>
</ul>
</section>
<section id="criterios-de-√©xito" class="level3">
<h3 class="anchored" data-anchor-id="criterios-de-√©xito">Criterios de √âxito</h3>
<p>Para que nuestro modelo sea √∫til en el contexto de negocio, establecemos los siguientes objetivos:</p>
<p><strong>M√©tricas Primarias:</strong></p>
<ol type="1">
<li><strong>RMSE (Root Mean Squared Error) &lt; 0.5</strong> ($50,000 USD de error promedio)
<ul>
<li>Penaliza errores grandes que son costosos en bienes ra√≠ces</li>
</ul></li>
<li><strong>R¬≤ (Coeficiente de Determinaci√≥n) &gt; 0.70</strong> (explica al menos 70% de la varianza)
<ul>
<li>Indica que el modelo captura patrones significativos</li>
</ul></li>
</ol>
<p><strong>M√©tricas Secundarias:</strong></p>
<ol start="3" type="1">
<li><strong>MAE (Mean Absolute Error) &lt; 0.4</strong> ($40,000 USD)
<ul>
<li>M√°s interpretable para stakeholders</li>
</ul></li>
<li><strong>MAPE (Mean Absolute Percentage Error) &lt; 15%</strong>
<ul>
<li>Error relativo aceptable para decisiones de negocio</li>
</ul></li>
</ol>
<p><strong>Modelo Baseline:</strong> Predictor de la media (nos dir√° si nuestros modelos realmente aportan valor)</p>
</section>
</section>
<section id="importar-librer√≠as-y-configuraci√≥n-inicial" class="level2">
<h2 class="anchored" data-anchor-id="importar-librer√≠as-y-configuraci√≥n-inicial">1. Importar Librer√≠as y Configuraci√≥n Inicial</h2>
<div id="cell-2" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Librer√≠as fundamentales</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Scikit-learn: Modelos y utilidades</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.datasets <span class="im">import</span> fetch_california_housing</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split, GridSearchCV, cross_val_score, KFold</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression, ElasticNet</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeRegressor, plot_tree</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestRegressor</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_squared_error, mean_absolute_error, r2_score</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co"># XGBoost</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> xgboost <span class="im">as</span> xgb</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Configuraci√≥n de visualizaci√≥n</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">'ignore'</span>)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>plt.style.use(<span class="st">'seaborn-v0_8-darkgrid'</span>)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>sns.set_palette(<span class="st">"husl"</span>)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'figure.figsize'</span>] <span class="op">=</span> (<span class="dv">12</span>, <span class="dv">6</span>)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'font.size'</span>] <span class="op">=</span> <span class="dv">11</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Para reproducibilidad</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"‚úì Librer√≠as importadas correctamente"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>‚úì Librer√≠as importadas correctamente</code></pre>
</div>
</div>
</section>
<section id="carga-y-exploraci√≥n-inicial-de-datos" class="level2">
<h2 class="anchored" data-anchor-id="carga-y-exploraci√≥n-inicial-de-datos">2. Carga y Exploraci√≥n Inicial de Datos</h2>
<div id="cell-4" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cargar el dataset de California Housing</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># as_frame=True nos devuelve un DataFrame de pandas en lugar de arrays numpy</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>housing_data <span class="op">=</span> fetch_california_housing(as_frame<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear DataFrame con caracter√≠sticas y target</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> housing_data.frame</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Dataset cargado exitosamente!"</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Dimensiones del dataset: </span><span class="sc">{</span>df<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"N√∫mero de observaciones: </span><span class="sc">{</span>df<span class="sc">.</span>shape[<span class="dv">0</span>]<span class="sc">:,}</span><span class="ss">"</span>)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"N√∫mero de caracter√≠sticas: </span><span class="sc">{</span>df<span class="sc">.</span>shape[<span class="dv">1</span>] <span class="op">-</span> <span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Dataset cargado exitosamente!
Dimensiones del dataset: (20640, 9)
N√∫mero de observaciones: 20,640
N√∫mero de caracter√≠sticas: 8</code></pre>
</div>
</div>
<div id="cell-5" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Primeras filas del dataset</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Primeras 10 observaciones del dataset:</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>df.head(<span class="dv">10</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Primeras 10 observaciones del dataset:
</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="39">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MedInc</th>
<th data-quarto-table-cell-role="th">HouseAge</th>
<th data-quarto-table-cell-role="th">AveRooms</th>
<th data-quarto-table-cell-role="th">AveBedrms</th>
<th data-quarto-table-cell-role="th">Population</th>
<th data-quarto-table-cell-role="th">AveOccup</th>
<th data-quarto-table-cell-role="th">Latitude</th>
<th data-quarto-table-cell-role="th">Longitude</th>
<th data-quarto-table-cell-role="th">MedHouseVal</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>8.3252</td>
<td>41.0</td>
<td>6.984127</td>
<td>1.023810</td>
<td>322.0</td>
<td>2.555556</td>
<td>37.88</td>
<td>-122.23</td>
<td>4.526</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>8.3014</td>
<td>21.0</td>
<td>6.238137</td>
<td>0.971880</td>
<td>2401.0</td>
<td>2.109842</td>
<td>37.86</td>
<td>-122.22</td>
<td>3.585</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>7.2574</td>
<td>52.0</td>
<td>8.288136</td>
<td>1.073446</td>
<td>496.0</td>
<td>2.802260</td>
<td>37.85</td>
<td>-122.24</td>
<td>3.521</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>5.6431</td>
<td>52.0</td>
<td>5.817352</td>
<td>1.073059</td>
<td>558.0</td>
<td>2.547945</td>
<td>37.85</td>
<td>-122.25</td>
<td>3.413</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>3.8462</td>
<td>52.0</td>
<td>6.281853</td>
<td>1.081081</td>
<td>565.0</td>
<td>2.181467</td>
<td>37.85</td>
<td>-122.25</td>
<td>3.422</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>4.0368</td>
<td>52.0</td>
<td>4.761658</td>
<td>1.103627</td>
<td>413.0</td>
<td>2.139896</td>
<td>37.85</td>
<td>-122.25</td>
<td>2.697</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>3.6591</td>
<td>52.0</td>
<td>4.931907</td>
<td>0.951362</td>
<td>1094.0</td>
<td>2.128405</td>
<td>37.84</td>
<td>-122.25</td>
<td>2.992</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>3.1200</td>
<td>52.0</td>
<td>4.797527</td>
<td>1.061824</td>
<td>1157.0</td>
<td>1.788253</td>
<td>37.84</td>
<td>-122.25</td>
<td>2.414</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>2.0804</td>
<td>42.0</td>
<td>4.294118</td>
<td>1.117647</td>
<td>1206.0</td>
<td>2.026891</td>
<td>37.84</td>
<td>-122.26</td>
<td>2.267</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>3.6912</td>
<td>52.0</td>
<td>4.970588</td>
<td>0.990196</td>
<td>1551.0</td>
<td>2.172269</td>
<td>37.84</td>
<td>-122.25</td>
<td>2.611</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-6" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Informaci√≥n del dataset</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Informaci√≥n del dataset:</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>df.info()</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"="</span><span class="op">*</span><span class="dv">60</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Observaci√≥n importante: No hay valores nulos en el dataset"</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">60</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Informaci√≥n del dataset:

&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 20640 entries, 0 to 20639
Data columns (total 9 columns):
 #   Column       Non-Null Count  Dtype  
---  ------       --------------  -----  
 0   MedInc       20640 non-null  float64
 1   HouseAge     20640 non-null  float64
 2   AveRooms     20640 non-null  float64
 3   AveBedrms    20640 non-null  float64
 4   Population   20640 non-null  float64
 5   AveOccup     20640 non-null  float64
 6   Latitude     20640 non-null  float64
 7   Longitude    20640 non-null  float64
 8   MedHouseVal  20640 non-null  float64
dtypes: float64(9)
memory usage: 1.4 MB

============================================================
Observaci√≥n importante: No hay valores nulos en el dataset
============================================================</code></pre>
</div>
</div>
<div id="cell-7" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estad√≠sticas descriptivas</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Estad√≠sticas descriptivas:</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>df.describe().<span class="bu">round</span>(<span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Estad√≠sticas descriptivas:
</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="41">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MedInc</th>
<th data-quarto-table-cell-role="th">HouseAge</th>
<th data-quarto-table-cell-role="th">AveRooms</th>
<th data-quarto-table-cell-role="th">AveBedrms</th>
<th data-quarto-table-cell-role="th">Population</th>
<th data-quarto-table-cell-role="th">AveOccup</th>
<th data-quarto-table-cell-role="th">Latitude</th>
<th data-quarto-table-cell-role="th">Longitude</th>
<th data-quarto-table-cell-role="th">MedHouseVal</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>20640.00</td>
<td>20640.00</td>
<td>20640.00</td>
<td>20640.00</td>
<td>20640.00</td>
<td>20640.00</td>
<td>20640.00</td>
<td>20640.00</td>
<td>20640.00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>3.87</td>
<td>28.64</td>
<td>5.43</td>
<td>1.10</td>
<td>1425.48</td>
<td>3.07</td>
<td>35.63</td>
<td>-119.57</td>
<td>2.07</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>1.90</td>
<td>12.59</td>
<td>2.47</td>
<td>0.47</td>
<td>1132.46</td>
<td>10.39</td>
<td>2.14</td>
<td>2.00</td>
<td>1.15</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>0.50</td>
<td>1.00</td>
<td>0.85</td>
<td>0.33</td>
<td>3.00</td>
<td>0.69</td>
<td>32.54</td>
<td>-124.35</td>
<td>0.15</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>2.56</td>
<td>18.00</td>
<td>4.44</td>
<td>1.01</td>
<td>787.00</td>
<td>2.43</td>
<td>33.93</td>
<td>-121.80</td>
<td>1.20</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>3.53</td>
<td>29.00</td>
<td>5.23</td>
<td>1.05</td>
<td>1166.00</td>
<td>2.82</td>
<td>34.26</td>
<td>-118.49</td>
<td>1.80</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>4.74</td>
<td>37.00</td>
<td>6.05</td>
<td>1.10</td>
<td>1725.00</td>
<td>3.28</td>
<td>37.71</td>
<td>-118.01</td>
<td>2.65</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>15.00</td>
<td>52.00</td>
<td>141.91</td>
<td>34.07</td>
<td>35682.00</td>
<td>1243.33</td>
<td>41.95</td>
<td>-114.31</td>
<td>5.00</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-8" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verificar valores nulos</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Valores nulos por columna:"</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.isnull().<span class="bu">sum</span>())</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">‚úì El dataset est√° completo, sin valores faltantes"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Valores nulos por columna:
MedInc         0
HouseAge       0
AveRooms       0
AveBedrms      0
Population     0
AveOccup       0
Latitude       0
Longitude      0
MedHouseVal    0
dtype: int64

‚úì El dataset est√° completo, sin valores faltantes</code></pre>
</div>
</div>
<div id="cell-9" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Nombres de columnas</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Columnas del dataset:"</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Caracter√≠sticas predictoras (X): </span><span class="sc">{</span>df<span class="sc">.</span>columns[:<span class="op">-</span><span class="dv">1</span>]<span class="sc">.</span>tolist()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Variable objetivo (y): </span><span class="sc">{</span>df<span class="sc">.</span>columns[<span class="op">-</span><span class="dv">1</span>]<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Columnas del dataset:

Caracter√≠sticas predictoras (X): ['MedInc', 'HouseAge', 'AveRooms', 'AveBedrms', 'Population', 'AveOccup', 'Latitude', 'Longitude']

Variable objetivo (y): MedHouseVal</code></pre>
</div>
</div>
</section>
<section id="an√°lisis-exploratorio-de-datos-eda" class="level2">
<h2 class="anchored" data-anchor-id="an√°lisis-exploratorio-de-datos-eda">3. An√°lisis Exploratorio de Datos (EDA)</h2>
<p>El EDA es fundamental para entender los datos antes de modelar. Buscaremos: - Distribuciones de variables - Relaciones entre variables - Outliers y anomal√≠as - Patrones geogr√°ficos</p>
<section id="an√°lisis-de-la-variable-objetivo" class="level3">
<h3 class="anchored" data-anchor-id="an√°lisis-de-la-variable-objetivo">3.1 An√°lisis de la Variable Objetivo</h3>
<div id="cell-12" class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># An√°lisis de la variable objetivo (MedHouseVal)</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">18</span>, <span class="dv">5</span>))</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">'An√°lisis de la Variable Objetivo: Valor Medio de Viviendas'</span>, fontsize<span class="op">=</span><span class="dv">16</span>, y<span class="op">=</span><span class="fl">1.02</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Histograma</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].hist(df[<span class="st">'MedHouseVal'</span>], bins<span class="op">=</span><span class="dv">50</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, color<span class="op">=</span><span class="st">'steelblue'</span>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xlabel(<span class="st">'Valor Medio de Vivienda ($100,000 USD)'</span>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylabel(<span class="st">'Frecuencia'</span>)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_title(<span class="st">'Distribuci√≥n del Valor de Viviendas'</span>)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].axvline(df[<span class="st">'MedHouseVal'</span>].mean(), color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="ss">f'Media: </span><span class="sc">{</span>df[<span class="st">"MedHouseVal"</span>]<span class="sc">.</span>mean()<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].axvline(df[<span class="st">'MedHouseVal'</span>].median(), color<span class="op">=</span><span class="st">'green'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="ss">f'Mediana: </span><span class="sc">{</span>df[<span class="st">"MedHouseVal"</span>]<span class="sc">.</span>median()<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].legend()</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Box plot</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].boxplot(df[<span class="st">'MedHouseVal'</span>], vert<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_ylabel(<span class="st">'Valor Medio de Vivienda ($100,000 USD)'</span>)</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_title(<span class="st">'Box Plot - Detecci√≥n de Outliers'</span>)</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a><span class="co"># KDE (Kernel Density Estimation)</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'MedHouseVal'</span>].plot(kind<span class="op">=</span><span class="st">'kde'</span>, ax<span class="op">=</span>axes[<span class="dv">2</span>], color<span class="op">=</span><span class="st">'steelblue'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].set_xlabel(<span class="st">'Valor Medio de Vivienda ($100,000 USD)'</span>)</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].set_ylabel(<span class="st">'Densidad'</span>)</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].set_title(<span class="st">'Estimaci√≥n de Densidad (KDE)'</span>)</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Identificar el tope de $500k</span></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>capped_values <span class="op">=</span> (df[<span class="st">'MedHouseVal'</span>] <span class="op">&gt;=</span> <span class="fl">5.0</span>).<span class="bu">sum</span>()</span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">‚ö†Ô∏è  Observaci√≥n importante: </span><span class="sc">{</span>capped_values<span class="sc">:,}</span><span class="ss"> observaciones (</span><span class="sc">{</span>capped_values<span class="op">/</span><span class="bu">len</span>(df)<span class="op">*</span><span class="dv">100</span><span class="sc">:.1f}</span><span class="ss">%) est√°n en el valor m√°ximo de 5.0 ($500,000)"</span>)</span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Esto indica un 'tope' artificial en el dataset - las viviendas con valor &gt;= $500k fueron truncadas."</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="california_housing_case_study_files/figure-html/cell-9-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
‚ö†Ô∏è  Observaci√≥n importante: 992 observaciones (4.8%) est√°n en el valor m√°ximo de 5.0 ($500,000)
Esto indica un 'tope' artificial en el dataset - las viviendas con valor &gt;= $500k fueron truncadas.</code></pre>
</div>
</div>
</section>
<section id="distribuci√≥n-de-caracter√≠sticas-predictoras" class="level3">
<h3 class="anchored" data-anchor-id="distribuci√≥n-de-caracter√≠sticas-predictoras">3.2 Distribuci√≥n de Caracter√≠sticas Predictoras</h3>
<div id="cell-14" class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Distribuci√≥n de todas las caracter√≠sticas</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">3</span>, <span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">18</span>, <span class="dv">14</span>))</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">'Distribuci√≥n de Caracter√≠sticas Predictoras'</span>, fontsize<span class="op">=</span><span class="dv">16</span>, y<span class="op">=</span><span class="fl">0.995</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>features <span class="op">=</span> df.columns[:<span class="op">-</span><span class="dv">1</span>]  <span class="co"># Todas excepto la variable objetivo</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span> plt.cm.Set3(np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, <span class="bu">len</span>(features)))</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx, (feature, ax, color) <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="bu">zip</span>(features, axes.flat, colors)):</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    ax.hist(df[feature], bins<span class="op">=</span><span class="dv">40</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, color<span class="op">=</span>color)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(feature)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(<span class="st">'Frecuencia'</span>)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    ax.set_title(<span class="ss">f'Distribuci√≥n de </span><span class="sc">{</span>feature<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Estad√≠sticas</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>    mean_val <span class="op">=</span> df[feature].mean()</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>    median_val <span class="op">=</span> df[feature].median()</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>    ax.axvline(mean_val, color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, label<span class="op">=</span><span class="ss">f'Media: </span><span class="sc">{</span>mean_val<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>    ax.axvline(median_val, color<span class="op">=</span><span class="st">'green'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, label<span class="op">=</span><span class="ss">f'Mediana: </span><span class="sc">{</span>median_val<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>    ax.legend(fontsize<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>    ax.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Ocultar el √∫ltimo subplot vac√≠o</span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>axes.flat[<span class="op">-</span><span class="dv">1</span>].axis(<span class="st">'off'</span>)</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">üìä Observaciones clave:"</span>)</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"- AveRooms, AveBedrms, AveOccup muestran distribuciones sesgadas con outliers"</span>)</span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"- Population tambi√©n est√° muy sesgada"</span>)</span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"- MedInc, HouseAge tienen distribuciones m√°s regulares"</span>)</span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"- Latitude y Longitude muestran la distribuci√≥n geogr√°fica de los datos"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="california_housing_case_study_files/figure-html/cell-10-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
üìä Observaciones clave:
- AveRooms, AveBedrms, AveOccup muestran distribuciones sesgadas con outliers
- Population tambi√©n est√° muy sesgada
- MedInc, HouseAge tienen distribuciones m√°s regulares
- Latitude y Longitude muestran la distribuci√≥n geogr√°fica de los datos</code></pre>
</div>
</div>
</section>
<section id="an√°lisis-de-correlaciones" class="level3">
<h3 class="anchored" data-anchor-id="an√°lisis-de-correlaciones">3.3 An√°lisis de Correlaciones</h3>
<div id="cell-16" class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Matriz de correlaci√≥n</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>correlation_matrix <span class="op">=</span> df.corr()</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Matriz de correlaci√≥n:</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(correlation_matrix.<span class="bu">round</span>(<span class="dv">3</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Matriz de correlaci√≥n:

             MedInc  HouseAge  AveRooms  AveBedrms  Population  AveOccup  \
MedInc        1.000    -0.119     0.327     -0.062       0.005     0.019   
HouseAge     -0.119     1.000    -0.153     -0.078      -0.296     0.013   
AveRooms      0.327    -0.153     1.000      0.848      -0.072    -0.005   
AveBedrms    -0.062    -0.078     0.848      1.000      -0.066    -0.006   
Population    0.005    -0.296    -0.072     -0.066       1.000     0.070   
AveOccup      0.019     0.013    -0.005     -0.006       0.070     1.000   
Latitude     -0.080     0.011     0.106      0.070      -0.109     0.002   
Longitude    -0.015    -0.108    -0.028      0.013       0.100     0.002   
MedHouseVal   0.688     0.106     0.152     -0.047      -0.025    -0.024   

             Latitude  Longitude  MedHouseVal  
MedInc         -0.080     -0.015        0.688  
HouseAge        0.011     -0.108        0.106  
AveRooms        0.106     -0.028        0.152  
AveBedrms       0.070      0.013       -0.047  
Population     -0.109      0.100       -0.025  
AveOccup        0.002      0.002       -0.024  
Latitude        1.000     -0.925       -0.144  
Longitude      -0.925      1.000       -0.046  
MedHouseVal    -0.144     -0.046        1.000  </code></pre>
</div>
</div>
<div id="cell-17" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualizaci√≥n de la matriz de correlaci√≥n</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">10</span>))</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>sns.heatmap(correlation_matrix, annot<span class="op">=</span><span class="va">True</span>, cmap<span class="op">=</span><span class="st">'coolwarm'</span>, center<span class="op">=</span><span class="dv">0</span>, </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>            square<span class="op">=</span><span class="va">True</span>, linewidths<span class="op">=</span><span class="dv">1</span>, fmt<span class="op">=</span><span class="st">'.2f'</span>, cbar_kws<span class="op">=</span>{<span class="st">"shrink"</span>: <span class="fl">0.8</span>})</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Matriz de Correlaci√≥n - California Housing Dataset'</span>, fontsize<span class="op">=</span><span class="dv">16</span>, pad<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">üîç Insights de correlaci√≥n:"</span>)</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Correlaci√≥n con MedHouseVal (variable objetivo):"</span>)</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>correlations_with_target <span class="op">=</span> correlation_matrix[<span class="st">'MedHouseVal'</span>].sort_values(ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(correlations_with_target.to_string())</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">üìå Conclusiones:"</span>)</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"- MedInc (ingreso medio) tiene la correlaci√≥n m√°s fuerte (0.688) - predictor clave"</span>)</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"- Latitude tiene correlaci√≥n negativa (-0.145) - m√°s al norte, menor precio"</span>)</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"- Longitude tiene correlaci√≥n negativa (-0.047) - m√°s al este (interior), menor precio"</span>)</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"- AveRooms y AveBedrms est√°n correlacionados entre s√≠ (multicolinealidad moderada)"</span>)</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"- Population tiene baja correlaci√≥n con el precio"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="california_housing_case_study_files/figure-html/cell-12-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
üîç Insights de correlaci√≥n:

Correlaci√≥n con MedHouseVal (variable objetivo):
MedHouseVal    1.000000
MedInc         0.688075
AveRooms       0.151948
HouseAge       0.105623
AveOccup      -0.023737
Population    -0.024650
Longitude     -0.045967
AveBedrms     -0.046701
Latitude      -0.144160

üìå Conclusiones:
- MedInc (ingreso medio) tiene la correlaci√≥n m√°s fuerte (0.688) - predictor clave
- Latitude tiene correlaci√≥n negativa (-0.145) - m√°s al norte, menor precio
- Longitude tiene correlaci√≥n negativa (-0.047) - m√°s al este (interior), menor precio
- AveRooms y AveBedrms est√°n correlacionados entre s√≠ (multicolinealidad moderada)
- Population tiene baja correlaci√≥n con el precio</code></pre>
</div>
</div>
</section>
<section id="relaciones-bivariadas-con-la-variable-objetivo" class="level3">
<h3 class="anchored" data-anchor-id="relaciones-bivariadas-con-la-variable-objetivo">3.4 Relaciones Bivariadas con la Variable Objetivo</h3>
<div id="cell-19" class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plots de caracter√≠sticas vs variable objetivo</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">4</span>, figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">10</span>))</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">'Relaci√≥n entre Caracter√≠sticas y Valor de Vivienda'</span>, fontsize<span class="op">=</span><span class="dv">16</span>, y<span class="op">=</span><span class="fl">0.995</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>features <span class="op">=</span> df.columns[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span> plt.cm.Set2(np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, <span class="bu">len</span>(features)))</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ax, feature, color <span class="kw">in</span> <span class="bu">zip</span>(axes.flat, features, colors):</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    ax.scatter(df[feature], df[<span class="st">'MedHouseVal'</span>], alpha<span class="op">=</span><span class="fl">0.3</span>, s<span class="op">=</span><span class="dv">10</span>, color<span class="op">=</span>color, edgecolors<span class="op">=</span><span class="st">'none'</span>)</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(feature)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(<span class="st">'MedHouseVal ($100k)'</span>)</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>    ax.set_title(<span class="ss">f'</span><span class="sc">{</span>feature<span class="sc">}</span><span class="ss"> vs MedHouseVal'</span>)</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>    ax.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Agregar l√≠nea de tendencia</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>    z <span class="op">=</span> np.polyfit(df[feature], df[<span class="st">'MedHouseVal'</span>], <span class="dv">1</span>)</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> np.poly1d(z)</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>    x_sorted <span class="op">=</span> np.sort(df[feature])</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>    ax.plot(x_sorted, p(x_sorted), <span class="st">"r--"</span>, alpha<span class="op">=</span><span class="fl">0.8</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Mostrar correlaci√≥n</span></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>    corr <span class="op">=</span> df[[feature, <span class="st">'MedHouseVal'</span>]].corr().iloc[<span class="dv">0</span>, <span class="dv">1</span>]</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>    ax.text(<span class="fl">0.05</span>, <span class="fl">0.95</span>, <span class="ss">f'r = </span><span class="sc">{</span>corr<span class="sc">:.3f}</span><span class="ss">'</span>, transform<span class="op">=</span>ax.transAxes, </span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>            fontsize<span class="op">=</span><span class="dv">10</span>, verticalalignment<span class="op">=</span><span class="st">'top'</span>, </span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>            bbox<span class="op">=</span><span class="bu">dict</span>(boxstyle<span class="op">=</span><span class="st">'round'</span>, facecolor<span class="op">=</span><span class="st">'white'</span>, alpha<span class="op">=</span><span class="fl">0.8</span>))</span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">üìà Observaciones clave:"</span>)</span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"- MedInc muestra relaci√≥n lineal clara y fuerte con MedHouseVal"</span>)</span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"- HouseAge muestra relaci√≥n no lineal (forma de U invertida)"</span>)</span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"- Las caracter√≠sticas geogr√°ficas (Lat/Lon) muestran patrones complejos"</span>)</span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"- Hay presencia de outliers en varias caracter√≠sticas"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="california_housing_case_study_files/figure-html/cell-13-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
üìà Observaciones clave:
- MedInc muestra relaci√≥n lineal clara y fuerte con MedHouseVal
- HouseAge muestra relaci√≥n no lineal (forma de U invertida)
- Las caracter√≠sticas geogr√°ficas (Lat/Lon) muestran patrones complejos
- Hay presencia de outliers en varias caracter√≠sticas</code></pre>
</div>
</div>
</section>
</section>
<section id="an√°lisis-geogr√°fico" class="level2">
<h2 class="anchored" data-anchor-id="an√°lisis-geogr√°fico">4. An√°lisis Geogr√°fico</h2>
<p>Esta es una de las visualizaciones m√°s importantes para este dataset. California tiene patrones geogr√°ficos muy marcados en los precios de vivienda.</p>
<div id="cell-21" class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mapa geogr√°fico de California coloreado por precio</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">10</span>))</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">'An√°lisis Geogr√°fico: Distribuci√≥n de Precios en California'</span>, fontsize<span class="op">=</span><span class="dv">18</span>, y<span class="op">=</span><span class="fl">0.98</span>)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Mapa 1: Scatter plot con color por precio</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>scatter1 <span class="op">=</span> axes[<span class="dv">0</span>].scatter(df[<span class="st">'Longitude'</span>], df[<span class="st">'Latitude'</span>], </span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>                           c<span class="op">=</span>df[<span class="st">'MedHouseVal'</span>], cmap<span class="op">=</span><span class="st">'YlOrRd'</span>, </span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>                           s<span class="op">=</span><span class="dv">20</span>, alpha<span class="op">=</span><span class="fl">0.4</span>, edgecolors<span class="op">=</span><span class="st">'none'</span>)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xlabel(<span class="st">'Longitud'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylabel(<span class="st">'Latitud'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_title(<span class="st">'Mapa de California: Valor de Viviendas'</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>cbar1 <span class="op">=</span> plt.colorbar(scatter1, ax<span class="op">=</span>axes[<span class="dv">0</span>])</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>cbar1.set_label(<span class="st">'Valor Medio ($100k USD)'</span>, fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Mapa 2: Scatter plot con tama√±o por precio y color por poblaci√≥n</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>scatter2 <span class="op">=</span> axes[<span class="dv">1</span>].scatter(df[<span class="st">'Longitude'</span>], df[<span class="st">'Latitude'</span>], </span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>                           c<span class="op">=</span>df[<span class="st">'MedHouseVal'</span>], cmap<span class="op">=</span><span class="st">'viridis'</span>,</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>                           s<span class="op">=</span>df[<span class="st">'Population'</span>]<span class="op">/</span><span class="dv">50</span>, alpha<span class="op">=</span><span class="fl">0.3</span>, edgecolors<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xlabel(<span class="st">'Longitud'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_ylabel(<span class="st">'Latitud'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_title(<span class="st">'Mapa de California: Precio y Poblaci√≥n'</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>cbar2 <span class="op">=</span> plt.colorbar(scatter2, ax<span class="op">=</span>axes[<span class="dv">1</span>])</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>cbar2.set_label(<span class="st">'Valor Medio ($100k USD)'</span>, fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">üó∫Ô∏è  Insights Geogr√°ficos Clave:"</span>)</span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">1. La forma de California es claramente visible en los datos"</span>)</span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">2. √Åreas Costeras = Precios Altos (rojo/amarillo intenso):"</span>)</span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   - Bay Area (San Francisco): Zona de precios m√°s altos"</span>)</span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   - Los Angeles: Concentraci√≥n de precios medios-altos"</span>)</span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   - San Diego: Precios elevados en la costa sur"</span>)</span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">3. Interior de California = Precios Bajos (azul/verde):"</span>)</span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   - Valle Central: Predominantemente precios bajos"</span>)</span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   - Zonas rurales del norte: Precios m√°s bajos"</span>)</span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">4. Prima Costera (Coastal Premium):"</span>)</span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   - La proximidad al oc√©ano es un factor determinante del precio"</span>)</span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   - Este patr√≥n geogr√°fico ser√° importante para nuestros modelos"</span>)</span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">üí° Implicaci√≥n para el modelado:"</span>)</span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   Las caracter√≠sticas geogr√°ficas (Latitude, Longitude) capturan"</span>)</span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   informaci√≥n valiosa y ser√°n importantes en los modelos."</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="california_housing_case_study_files/figure-html/cell-14-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
üó∫Ô∏è  Insights Geogr√°ficos Clave:

1. La forma de California es claramente visible en los datos

2. √Åreas Costeras = Precios Altos (rojo/amarillo intenso):
   - Bay Area (San Francisco): Zona de precios m√°s altos
   - Los Angeles: Concentraci√≥n de precios medios-altos
   - San Diego: Precios elevados en la costa sur

3. Interior de California = Precios Bajos (azul/verde):
   - Valle Central: Predominantemente precios bajos
   - Zonas rurales del norte: Precios m√°s bajos

4. Prima Costera (Coastal Premium):
   - La proximidad al oc√©ano es un factor determinante del precio
   - Este patr√≥n geogr√°fico ser√° importante para nuestros modelos

üí° Implicaci√≥n para el modelado:
   Las caracter√≠sticas geogr√°ficas (Latitude, Longitude) capturan
   informaci√≥n valiosa y ser√°n importantes en los modelos.</code></pre>
</div>
</div>
</section>
<section id="preparaci√≥n-de-datos" class="level2">
<h2 class="anchored" data-anchor-id="preparaci√≥n-de-datos">5. Preparaci√≥n de Datos</h2>
<p>Antes de modelar, necesitamos preparar los datos: 1. Manejar outliers 2. Dividir en train/test 3. Escalar caracter√≠sticas (para modelos lineales)</p>
<section id="detecci√≥n-y-manejo-de-outliers" class="level3">
<h3 class="anchored" data-anchor-id="detecci√≥n-y-manejo-de-outliers">5.1 Detecci√≥n y Manejo de Outliers</h3>
<div id="cell-24" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identificar outliers usando el m√©todo IQR (Rango Intercuart√≠lico)</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> detect_outliers_iqr(data, columns, threshold<span class="op">=</span><span class="dv">3</span>):</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co">    Detecta outliers usando el m√©todo IQR</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="co">    threshold: multiplicador del IQR (t√≠picamente 1.5 o 3)</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    outliers_dict <span class="op">=</span> {}</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col <span class="kw">in</span> columns:</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>        Q1 <span class="op">=</span> data[col].quantile(<span class="fl">0.25</span>)</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>        Q3 <span class="op">=</span> data[col].quantile(<span class="fl">0.75</span>)</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>        IQR <span class="op">=</span> Q3 <span class="op">-</span> Q1</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>        lower_bound <span class="op">=</span> Q1 <span class="op">-</span> threshold <span class="op">*</span> IQR</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>        upper_bound <span class="op">=</span> Q3 <span class="op">+</span> threshold <span class="op">*</span> IQR</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>        outliers <span class="op">=</span> data[(data[col] <span class="op">&lt;</span> lower_bound) <span class="op">|</span> (data[col] <span class="op">&gt;</span> upper_bound)]</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>        outliers_dict[col] <span class="op">=</span> {</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>            <span class="st">'count'</span>: <span class="bu">len</span>(outliers),</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>            <span class="st">'percentage'</span>: <span class="bu">len</span>(outliers) <span class="op">/</span> <span class="bu">len</span>(data) <span class="op">*</span> <span class="dv">100</span>,</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>            <span class="st">'lower_bound'</span>: lower_bound,</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>            <span class="st">'upper_bound'</span>: upper_bound</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> outliers_dict</span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Columnas susceptibles a outliers (excluimos Lat/Lon porque son geogr√°ficas)</span></span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>columns_to_check <span class="op">=</span> [<span class="st">'MedInc'</span>, <span class="st">'HouseAge'</span>, <span class="st">'AveRooms'</span>, <span class="st">'AveBedrms'</span>, <span class="st">'Population'</span>, <span class="st">'AveOccup'</span>]</span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>outliers_info <span class="op">=</span> detect_outliers_iqr(df, columns_to_check, threshold<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"An√°lisis de Outliers (m√©todo IQR con threshold=3):</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="st">'Variable'</span><span class="sc">:&lt;15}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'Outliers'</span><span class="sc">:&lt;10}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'Porcentaje'</span><span class="sc">:&lt;12}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'L√≠mite Inferior'</span><span class="sc">:&lt;18}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'L√≠mite Superior'</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">85</span>)</span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col, info <span class="kw">in</span> outliers_info.items():</span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>col<span class="sc">:&lt;15}</span><span class="ss"> </span><span class="sc">{</span>info[<span class="st">'count'</span>]<span class="sc">:&lt;10}</span><span class="ss"> </span><span class="sc">{</span>info[<span class="st">'percentage'</span>]<span class="sc">:&lt;11.2f}</span><span class="ss">% </span><span class="sc">{</span>info[<span class="st">'lower_bound'</span>]<span class="sc">:&lt;18.2f}</span><span class="ss"> </span><span class="sc">{</span>info[<span class="st">'upper_bound'</span>]<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">üéØ Decisi√≥n: Para este caso de estudio, mantendremos los outliers porque:"</span>)</span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   1. Los valores extremos pueden ser reales (ej: mansiones con muchas habitaciones)"</span>)</span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   2. Los modelos basados en √°rboles son robustos a outliers"</span>)</span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   3. Queremos que el modelo sea capaz de predecir todo el rango de precios"</span>)</span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">   Nota: En un proyecto real, investigar√≠amos estos casos con expertos del dominio."</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>An√°lisis de Outliers (m√©todo IQR con threshold=3):

Variable        Outliers   Porcentaje   L√≠mite Inferior    L√≠mite Superior
=====================================================================================
MedInc          140        0.68       % -3.98              11.28
HouseAge        0          0.00       % -39.00             94.00
AveRooms        180        0.87       % -0.39              10.89
AveBedrms       724        3.51       % 0.73               1.38
Population      421        2.04       % -2027.00           4539.00
AveOccup        132        0.64       % -0.13              5.84

üéØ Decisi√≥n: Para este caso de estudio, mantendremos los outliers porque:
   1. Los valores extremos pueden ser reales (ej: mansiones con muchas habitaciones)
   2. Los modelos basados en √°rboles son robustos a outliers
   3. Queremos que el modelo sea capaz de predecir todo el rango de precios

   Nota: En un proyecto real, investigar√≠amos estos casos con expertos del dominio.</code></pre>
</div>
</div>
</section>
<section id="divisi√≥n-traintest-y-separaci√≥n-xy" class="level3">
<h3 class="anchored" data-anchor-id="divisi√≥n-traintest-y-separaci√≥n-xy">5.2 Divisi√≥n Train/Test y Separaci√≥n X/y</h3>
<div id="cell-26" class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Separar caracter√≠sticas (X) y variable objetivo (y)</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> df.drop(<span class="st">'MedHouseVal'</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[<span class="st">'MedHouseVal'</span>]</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Separaci√≥n de caracter√≠sticas y variable objetivo:"</span>)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Caracter√≠sticas (X): </span><span class="sc">{</span>X<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Variable objetivo (y): </span><span class="sc">{</span>y<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Columnas de X: </span><span class="sc">{</span>X<span class="sc">.</span>columns<span class="sc">.</span>tolist()<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Separaci√≥n de caracter√≠sticas y variable objetivo:

Caracter√≠sticas (X): (20640, 8)
Variable objetivo (y): (20640,)

Columnas de X: ['MedInc', 'HouseAge', 'AveRooms', 'AveBedrms', 'Population', 'AveOccup', 'Latitude', 'Longitude']</code></pre>
</div>
</div>
<div id="cell-27" class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Divisi√≥n estrat√©gica: 80% entrenamiento, 20% prueba</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co"># random_state=42 para reproducibilidad</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    X, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Divisi√≥n Train/Test completada:"</span>)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">60</span>)</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Conjunto de entrenamiento: </span><span class="sc">{</span>X_train<span class="sc">.</span>shape[<span class="dv">0</span>]<span class="sc">:,}</span><span class="ss"> observaciones (</span><span class="sc">{</span>X_train<span class="sc">.</span>shape[<span class="dv">0</span>]<span class="op">/</span><span class="bu">len</span>(X)<span class="op">*</span><span class="dv">100</span><span class="sc">:.1f}</span><span class="ss">%)"</span>)</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Conjunto de prueba:        </span><span class="sc">{</span>X_test<span class="sc">.</span>shape[<span class="dv">0</span>]<span class="sc">:,}</span><span class="ss"> observaciones (</span><span class="sc">{</span>X_test<span class="sc">.</span>shape[<span class="dv">0</span>]<span class="op">/</span><span class="bu">len</span>(X)<span class="op">*</span><span class="dv">100</span><span class="sc">:.1f}</span><span class="ss">%)"</span>)</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">üìù Nota: El conjunto de prueba se utilizar√° √öNICAMENTE para la evaluaci√≥n final."</span>)</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"         La selecci√≥n de modelos e hiperpar√°metros se har√° con validaci√≥n cruzada en el conjunto de entrenamiento."</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Divisi√≥n Train/Test completada:
============================================================
Conjunto de entrenamiento: 16,512 observaciones (80.0%)
Conjunto de prueba:        4,128 observaciones (20.0%)

üìù Nota: El conjunto de prueba se utilizar√° √öNICAMENTE para la evaluaci√≥n final.
         La selecci√≥n de modelos e hiperpar√°metros se har√° con validaci√≥n cruzada en el conjunto de entrenamiento.</code></pre>
</div>
</div>
</section>
<section id="escalado-de-caracter√≠sticas" class="level3">
<h3 class="anchored" data-anchor-id="escalado-de-caracter√≠sticas">5.3 Escalado de Caracter√≠sticas</h3>
<div id="cell-29" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Escalado usando StandardScaler (necesario para modelos lineales)</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Los modelos basados en √°rboles NO requieren escalado</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajustar el scaler SOLO con datos de entrenamiento (evitar data leakage)</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>X_train_scaled <span class="op">=</span> scaler.fit_transform(X_train)</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>X_test_scaled <span class="op">=</span> scaler.transform(X_test)</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Convertir de vuelta a DataFrame para mantener nombres de columnas</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>X_train_scaled <span class="op">=</span> pd.DataFrame(X_train_scaled, columns<span class="op">=</span>X.columns, index<span class="op">=</span>X_train.index)</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>X_test_scaled <span class="op">=</span> pd.DataFrame(X_test_scaled, columns<span class="op">=</span>X.columns, index<span class="op">=</span>X_test.index)</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Escalado de caracter√≠sticas completado:"</span>)</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Verificaci√≥n de estandarizaci√≥n (debe ser ~0 y ~1):"</span>)</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Media de X_train_scaled:</span><span class="ch">\n</span><span class="sc">{</span>X_train_scaled<span class="sc">.</span>mean()<span class="sc">.</span><span class="bu">round</span>(<span class="dv">10</span>)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Desviaci√≥n est√°ndar de X_train_scaled:</span><span class="ch">\n</span><span class="sc">{</span>X_train_scaled<span class="sc">.</span>std()<span class="sc">.</span><span class="bu">round</span>(<span class="dv">2</span>)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">‚úì Datos escalados correctamente"</span>)</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">üí° Recordatorio: Usaremos X_train_scaled/X_test_scaled para modelos lineales,"</span>)</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   y X_train/X_test (sin escalar) para modelos basados en √°rboles."</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Escalado de caracter√≠sticas completado:

Verificaci√≥n de estandarizaci√≥n (debe ser ~0 y ~1):
Media de X_train_scaled:
MedInc       -0.0
HouseAge     -0.0
AveRooms      0.0
AveBedrms    -0.0
Population    0.0
AveOccup      0.0
Latitude      0.0
Longitude     0.0
dtype: float64

Desviaci√≥n est√°ndar de X_train_scaled:
MedInc        1.0
HouseAge      1.0
AveRooms      1.0
AveBedrms     1.0
Population    1.0
AveOccup      1.0
Latitude      1.0
Longitude     1.0
dtype: float64

‚úì Datos escalados correctamente

üí° Recordatorio: Usaremos X_train_scaled/X_test_scaled para modelos lineales,
   y X_train/X_test (sin escalar) para modelos basados en √°rboles.</code></pre>
</div>
</div>
</section>
<section id="modelo-baseline-predictor-de-la-media" class="level3">
<h3 class="anchored" data-anchor-id="modelo-baseline-predictor-de-la-media">5.4 Modelo Baseline (Predictor de la Media)</h3>
<div id="cell-31" class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo baseline: predecir siempre la media del training set</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Este es el m√≠nimo rendimiento que cualquier modelo debe superar</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>y_train_mean <span class="op">=</span> y_train.mean()</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>y_pred_baseline <span class="op">=</span> np.full(<span class="bu">len</span>(y_test), y_train_mean)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="co"># M√©tricas del baseline</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>baseline_rmse <span class="op">=</span> np.sqrt(mean_squared_error(y_test, y_pred_baseline))</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>baseline_mae <span class="op">=</span> mean_absolute_error(y_test, y_pred_baseline)</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>baseline_r2 <span class="op">=</span> r2_score(y_test, y_pred_baseline)</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_mape(y_true, y_pred):</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Calcula Mean Absolute Percentage Error"""</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.mean(np.<span class="bu">abs</span>((y_true <span class="op">-</span> y_pred) <span class="op">/</span> y_true)) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>baseline_mape <span class="op">=</span> calculate_mape(y_test, y_pred_baseline)</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"MODELO BASELINE: PREDICTOR DE LA MEDIA"</span>)</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Predicci√≥n constante: $</span><span class="sc">{</span>y_train_mean<span class="sc">:.2f}</span><span class="ss"> ($</span><span class="sc">{</span>y_train_mean<span class="op">*</span><span class="dv">100000</span><span class="sc">:,.0f}</span><span class="ss"> USD)"</span>)</span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">M√©tricas en conjunto de prueba:"</span>)</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  RMSE:  </span><span class="sc">{</span>baseline_rmse<span class="sc">:.4f}</span><span class="ss"> ($</span><span class="sc">{</span>baseline_rmse<span class="op">*</span><span class="dv">100000</span><span class="sc">:,.0f}</span><span class="ss"> USD)"</span>)</span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  MAE:   </span><span class="sc">{</span>baseline_mae<span class="sc">:.4f}</span><span class="ss"> ($</span><span class="sc">{</span>baseline_mae<span class="op">*</span><span class="dv">100000</span><span class="sc">:,.0f}</span><span class="ss"> USD)"</span>)</span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  R¬≤:    </span><span class="sc">{</span>baseline_r2<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  MAPE:  </span><span class="sc">{</span>baseline_mape<span class="sc">:.2f}</span><span class="ss">%"</span>)</span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">üéØ Este es el benchmark m√≠nimo que nuestros modelos deben superar."</span>)</span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   Cualquier modelo con RMSE &gt; </span><span class="sc">{:.4f}</span><span class="st"> es peor que simplemente predecir la media."</span>.<span class="bu">format</span>(baseline_rmse))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
MODELO BASELINE: PREDICTOR DE LA MEDIA
======================================================================

Predicci√≥n constante: $2.07 ($207,195 USD)

M√©tricas en conjunto de prueba:
  RMSE:  1.1449 ($114,486 USD)
  MAE:   0.9061 ($90,607 USD)
  R¬≤:    -0.0002
  MAPE:  62.89%

üéØ Este es el benchmark m√≠nimo que nuestros modelos deben superar.
   Cualquier modelo con RMSE &gt; 1.1449 es peor que simplemente predecir la media.</code></pre>
</div>
</div>
</section>
</section>
<section id="modelado-1-regresi√≥n-lineal-y-elastic-net" class="level2">
<h2 class="anchored" data-anchor-id="modelado-1-regresi√≥n-lineal-y-elastic-net">6. Modelado 1: Regresi√≥n Lineal y Elastic Net</h2>
<p>Comenzamos con modelos lineales para establecer un baseline interpretable.</p>
<section id="regresi√≥n-lineal-ordinary-least-squares" class="level3">
<h3 class="anchored" data-anchor-id="regresi√≥n-lineal-ordinary-least-squares">6.1 Regresi√≥n Lineal (Ordinary Least Squares)</h3>
<div id="cell-34" class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Entrenar modelo de regresi√≥n lineal</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>lr_model <span class="op">=</span> LinearRegression()</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>lr_model.fit(X_train_scaled, y_train)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicciones</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>y_pred_lr_train <span class="op">=</span> lr_model.predict(X_train_scaled)</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>y_pred_lr_test <span class="op">=</span> lr_model.predict(X_test_scaled)</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="co"># M√©tricas</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>lr_rmse_train <span class="op">=</span> np.sqrt(mean_squared_error(y_train, y_pred_lr_train))</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>lr_rmse_test <span class="op">=</span> np.sqrt(mean_squared_error(y_test, y_pred_lr_test))</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>lr_mae_train <span class="op">=</span> mean_absolute_error(y_train, y_pred_lr_train)</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>lr_mae_test <span class="op">=</span> mean_absolute_error(y_test, y_pred_lr_test)</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>lr_r2_train <span class="op">=</span> r2_score(y_train, y_pred_lr_train)</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>lr_r2_test <span class="op">=</span> r2_score(y_test, y_pred_lr_test)</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>lr_mape_test <span class="op">=</span> calculate_mape(y_test, y_pred_lr_test)</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"REGRESI√ìN LINEAL (ORDINARY LEAST SQUARES)"</span>)</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">üìä Coeficientes del modelo:"</span>)</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Caracter√≠stica    Coeficiente    Interpretaci√≥n"</span>)</span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>coef_df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Caracter√≠stica'</span>: X.columns,</span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Coeficiente'</span>: lr_model.coef_</span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>}).sort_values(<span class="st">'Coeficiente'</span>, key<span class="op">=</span><span class="bu">abs</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _, row <span class="kw">in</span> coef_df.iterrows():</span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a>    feat <span class="op">=</span> row[<span class="st">'Caracter√≠stica'</span>]</span>
<span id="cb37-32"><a href="#cb37-32" aria-hidden="true" tabindex="-1"></a>    coef <span class="op">=</span> row[<span class="st">'Coeficiente'</span>]</span>
<span id="cb37-33"><a href="#cb37-33" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>feat<span class="sc">:&lt;18}</span><span class="ss"> </span><span class="sc">{</span>coef<span class="sc">:&gt;10.6f}</span><span class="ss">    </span><span class="sc">{</span><span class="st">'‚Üë Aumenta precio'</span> <span class="cf">if</span> coef <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="st">'‚Üì Disminuye precio'</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb37-34"><a href="#cb37-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-35"><a href="#cb37-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Intercepto: </span><span class="sc">{</span>lr_model<span class="sc">.</span>intercept_<span class="sc">:.6f}</span><span class="ss">"</span>)</span>
<span id="cb37-36"><a href="#cb37-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-37"><a href="#cb37-37" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">üìà M√©tricas de Rendimiento:"</span>)</span>
<span id="cb37-38"><a href="#cb37-38" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">" "</span><span class="op">*</span><span class="dv">20</span> <span class="op">+</span> <span class="st">"Train        Test"</span>)</span>
<span id="cb37-39"><a href="#cb37-39" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">50</span>)</span>
<span id="cb37-40"><a href="#cb37-40" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="st">'RMSE'</span><span class="sc">:&lt;20}</span><span class="ss"> </span><span class="sc">{</span>lr_rmse_train<span class="sc">:&gt;10.4f}</span><span class="ss">   </span><span class="sc">{</span>lr_rmse_test<span class="sc">:&gt;10.4f}</span><span class="ss">"</span>)</span>
<span id="cb37-41"><a href="#cb37-41" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="st">'MAE'</span><span class="sc">:&lt;20}</span><span class="ss"> </span><span class="sc">{</span>lr_mae_train<span class="sc">:&gt;10.4f}</span><span class="ss">   </span><span class="sc">{</span>lr_mae_test<span class="sc">:&gt;10.4f}</span><span class="ss">"</span>)</span>
<span id="cb37-42"><a href="#cb37-42" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="st">'R¬≤'</span><span class="sc">:&lt;20}</span><span class="ss"> </span><span class="sc">{</span>lr_r2_train<span class="sc">:&gt;10.4f}</span><span class="ss">   </span><span class="sc">{</span>lr_r2_test<span class="sc">:&gt;10.4f}</span><span class="ss">"</span>)</span>
<span id="cb37-43"><a href="#cb37-43" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="st">'MAPE (%)'</span><span class="sc">:&lt;20}</span><span class="ss"> </span><span class="sc">{</span><span class="st">''</span><span class="sc">:&gt;10}</span><span class="ss">   </span><span class="sc">{</span>lr_mape_test<span class="sc">:&gt;10.2f}</span><span class="ss">"</span>)</span>
<span id="cb37-44"><a href="#cb37-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-45"><a href="#cb37-45" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">‚úÖ Evaluaci√≥n vs Criterios de √âxito:"</span>)</span>
<span id="cb37-46"><a href="#cb37-46" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   RMSE &lt; 0.5:  </span><span class="sc">{</span><span class="st">'‚úì CUMPLE'</span> <span class="cf">if</span> lr_rmse_test <span class="op">&lt;</span> <span class="fl">0.5</span> <span class="cf">else</span> <span class="st">'‚úó NO CUMPLE'</span><span class="sc">}</span><span class="ss"> (actual: </span><span class="sc">{</span>lr_rmse_test<span class="sc">:.4f}</span><span class="ss">)"</span>)</span>
<span id="cb37-47"><a href="#cb37-47" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   R¬≤ &gt; 0.70:   </span><span class="sc">{</span><span class="st">'‚úì CUMPLE'</span> <span class="cf">if</span> lr_r2_test <span class="op">&gt;</span> <span class="fl">0.70</span> <span class="cf">else</span> <span class="st">'‚úó NO CUMPLE'</span><span class="sc">}</span><span class="ss"> (actual: </span><span class="sc">{</span>lr_r2_test<span class="sc">:.4f}</span><span class="ss">)"</span>)</span>
<span id="cb37-48"><a href="#cb37-48" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   MAE &lt; 0.4:   </span><span class="sc">{</span><span class="st">'‚úì CUMPLE'</span> <span class="cf">if</span> lr_mae_test <span class="op">&lt;</span> <span class="fl">0.4</span> <span class="cf">else</span> <span class="st">'‚úó NO CUMPLE'</span><span class="sc">}</span><span class="ss"> (actual: </span><span class="sc">{</span>lr_mae_test<span class="sc">:.4f}</span><span class="ss">)"</span>)</span>
<span id="cb37-49"><a href="#cb37-49" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   MAPE &lt; 15%:  </span><span class="sc">{</span><span class="st">'‚úì CUMPLE'</span> <span class="cf">if</span> lr_mape_test <span class="op">&lt;</span> <span class="dv">15</span> <span class="cf">else</span> <span class="st">'‚úó NO CUMPLE'</span><span class="sc">}</span><span class="ss"> (actual: </span><span class="sc">{</span>lr_mape_test<span class="sc">:.2f}</span><span class="ss">%)"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
REGRESI√ìN LINEAL (ORDINARY LEAST SQUARES)
======================================================================

üìä Coeficientes del modelo:

Caracter√≠stica    Coeficiente    Interpretaci√≥n
----------------------------------------------------------------------
Latitude            -0.896929    ‚Üì Disminuye precio
Longitude           -0.869842    ‚Üì Disminuye precio
MedInc               0.854383    ‚Üë Aumenta precio
AveBedrms            0.339259    ‚Üë Aumenta precio
AveRooms            -0.294410    ‚Üì Disminuye precio
HouseAge             0.122546    ‚Üë Aumenta precio
AveOccup            -0.040829    ‚Üì Disminuye precio
Population          -0.002308    ‚Üì Disminuye precio

Intercepto: 2.071947

üìà M√©tricas de Rendimiento:

                    Train        Test
--------------------------------------------------
RMSE                     0.7197       0.7456
MAE                      0.5286       0.5332
R¬≤                       0.6126       0.5758
MAPE (%)                               31.95

‚úÖ Evaluaci√≥n vs Criterios de √âxito:
   RMSE &lt; 0.5:  ‚úó NO CUMPLE (actual: 0.7456)
   R¬≤ &gt; 0.70:   ‚úó NO CUMPLE (actual: 0.5758)
   MAE &lt; 0.4:   ‚úó NO CUMPLE (actual: 0.5332)
   MAPE &lt; 15%:  ‚úó NO CUMPLE (actual: 31.95%)</code></pre>
</div>
</div>
<div id="cell-35" class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualizaci√≥n de coeficientes</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>coef_df_sorted <span class="op">=</span> coef_df.sort_values(<span class="st">'Coeficiente'</span>)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span> [<span class="st">'red'</span> <span class="cf">if</span> c <span class="op">&lt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="st">'green'</span> <span class="cf">for</span> c <span class="kw">in</span> coef_df_sorted[<span class="st">'Coeficiente'</span>]]</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>bars <span class="op">=</span> ax.barh(coef_df_sorted[<span class="st">'Caracter√≠stica'</span>], coef_df_sorted[<span class="st">'Coeficiente'</span>], color<span class="op">=</span>colors, alpha<span class="op">=</span><span class="fl">0.7</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Coeficiente (en escala estandarizada)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Coeficientes de Regresi√≥n Lineal - Importancia de Caracter√≠sticas'</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>ax.axvline(x<span class="op">=</span><span class="dv">0</span>, color<span class="op">=</span><span class="st">'black'</span>, linestyle<span class="op">=</span><span class="st">'-'</span>, linewidth<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>ax.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>, axis<span class="op">=</span><span class="st">'x'</span>)</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a><span class="co"># A√±adir valores</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> bar <span class="kw">in</span> bars:</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>    width <span class="op">=</span> bar.get_width()</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>    ax.text(width, bar.get_y() <span class="op">+</span> bar.get_height()<span class="op">/</span><span class="dv">2</span>, <span class="ss">f'</span><span class="sc">{</span>width<span class="sc">:.3f}</span><span class="ss">'</span>,</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>            ha<span class="op">=</span><span class="st">'left'</span> <span class="cf">if</span> width <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="st">'right'</span>, va<span class="op">=</span><span class="st">'center'</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">üí° Interpretaci√≥n de coeficientes (datos estandarizados):"</span>)</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   - Valores positivos: aumentan el precio"</span>)</span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   - Valores negativos: disminuyen el precio"</span>)</span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   - Magnitud: importancia relativa de cada caracter√≠stica"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="california_housing_case_study_files/figure-html/cell-21-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
üí° Interpretaci√≥n de coeficientes (datos estandarizados):
   - Valores positivos: aumentan el precio
   - Valores negativos: disminuyen el precio
   - Magnitud: importancia relativa de cada caracter√≠stica</code></pre>
</div>
</div>
</section>
<section id="elastic-net-con-validaci√≥n-cruzada" class="level3">
<h3 class="anchored" data-anchor-id="elastic-net-con-validaci√≥n-cruzada">6.2 Elastic Net con Validaci√≥n Cruzada</h3>
<div id="cell-37" class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Elastic Net combina L1 (Lasso) y L2 (Ridge) regularization</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Hiperpar√°metros:</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   - alpha: fuerza de la regularizaci√≥n</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   - l1_ratio: balance entre L1 y L2 (0=Ridge, 1=Lasso, 0.5=50/50)</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Entrenando Elastic Net con GridSearchCV..."</span>)</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Esto puede tomar algunos minutos...</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Definir grilla de hiperpar√°metros</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>param_grid_elasticnet <span class="op">=</span> {</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'alpha'</span>: [<span class="fl">0.0001</span>, <span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="fl">1.0</span>, <span class="fl">10.0</span>],</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'l1_ratio'</span>: [<span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">0.5</span>, <span class="fl">0.7</span>, <span class="fl">0.9</span>]</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a><span class="co"># GridSearchCV con 5-fold cross-validation</span></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>elasticnet <span class="op">=</span> ElasticNet(random_state<span class="op">=</span><span class="dv">42</span>, max_iter<span class="op">=</span><span class="dv">10000</span>)</span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>grid_elasticnet <span class="op">=</span> GridSearchCV(</span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>    elasticnet,</span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>    param_grid_elasticnet,</span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>    cv<span class="op">=</span><span class="dv">5</span>,</span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>    scoring<span class="op">=</span><span class="st">'neg_root_mean_squared_error'</span>,</span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>    n_jobs<span class="op">=-</span><span class="dv">1</span>,</span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>    verbose<span class="op">=</span><span class="dv">1</span></span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a>grid_elasticnet.fit(X_train_scaled, y_train)</span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">‚úì B√∫squeda completada"</span>)</span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Mejores hiperpar√°metros encontrados:"</span>)</span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  alpha:    </span><span class="sc">{</span>grid_elasticnet<span class="sc">.</span>best_params_[<span class="st">'alpha'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  l1_ratio: </span><span class="sc">{</span>grid_elasticnet<span class="sc">.</span>best_params_[<span class="st">'l1_ratio'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Mejor RMSE en validaci√≥n cruzada: </span><span class="sc">{</span><span class="op">-</span>grid_elasticnet<span class="sc">.</span>best_score_<span class="sc">:.4f}</span><span class="ss">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Entrenando Elastic Net con GridSearchCV...
Esto puede tomar algunos minutos...

Fitting 5 folds for each of 30 candidates, totalling 150 fits

‚úì B√∫squeda completada

Mejores hiperpar√°metros encontrados:
  alpha:    0.001
  l1_ratio: 0.9

Mejor RMSE en validaci√≥n cruzada: 0.7205</code></pre>
</div>
</div>
<div id="cell-38" class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mejor modelo Elastic Net</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>best_elasticnet <span class="op">=</span> grid_elasticnet.best_estimator_</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicciones</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>y_pred_en_train <span class="op">=</span> best_elasticnet.predict(X_train_scaled)</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>y_pred_en_test <span class="op">=</span> best_elasticnet.predict(X_test_scaled)</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="co"># M√©tricas</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>en_rmse_train <span class="op">=</span> np.sqrt(mean_squared_error(y_train, y_pred_en_train))</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>en_rmse_test <span class="op">=</span> np.sqrt(mean_squared_error(y_test, y_pred_en_test))</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>en_mae_train <span class="op">=</span> mean_absolute_error(y_train, y_pred_en_train)</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>en_mae_test <span class="op">=</span> mean_absolute_error(y_test, y_pred_en_test)</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>en_r2_train <span class="op">=</span> r2_score(y_train, y_pred_en_train)</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>en_r2_test <span class="op">=</span> r2_score(y_test, y_pred_en_test)</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>en_mape_test <span class="op">=</span> calculate_mape(y_test, y_pred_en_test)</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"ELASTIC NET REGRESSION"</span>)</span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Hiperpar√°metros: alpha=</span><span class="sc">{</span>grid_elasticnet<span class="sc">.</span>best_params_[<span class="st">'alpha'</span>]<span class="sc">}</span><span class="ss">, l1_ratio=</span><span class="sc">{</span>grid_elasticnet<span class="sc">.</span>best_params_[<span class="st">'l1_ratio'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">üìä Coeficientes del modelo:"</span>)</span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a>coef_en_df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Caracter√≠stica'</span>: X.columns,</span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Coeficiente'</span>: best_elasticnet.coef_</span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a>}).sort_values(<span class="st">'Coeficiente'</span>, key<span class="op">=</span><span class="bu">abs</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Caracter√≠stica    Coeficiente    Status"</span>)</span>
<span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">60</span>)</span>
<span id="cb43-30"><a href="#cb43-30" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _, row <span class="kw">in</span> coef_en_df.iterrows():</span>
<span id="cb43-31"><a href="#cb43-31" aria-hidden="true" tabindex="-1"></a>    feat <span class="op">=</span> row[<span class="st">'Caracter√≠stica'</span>]</span>
<span id="cb43-32"><a href="#cb43-32" aria-hidden="true" tabindex="-1"></a>    coef <span class="op">=</span> row[<span class="st">'Coeficiente'</span>]</span>
<span id="cb43-33"><a href="#cb43-33" aria-hidden="true" tabindex="-1"></a>    status <span class="op">=</span> <span class="st">"Eliminada"</span> <span class="cf">if</span> <span class="bu">abs</span>(coef) <span class="op">&lt;</span> <span class="fl">0.0001</span> <span class="cf">else</span> <span class="st">"Activa"</span></span>
<span id="cb43-34"><a href="#cb43-34" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>feat<span class="sc">:&lt;18}</span><span class="ss"> </span><span class="sc">{</span>coef<span class="sc">:&gt;10.6f}</span><span class="ss">    </span><span class="sc">{</span>status<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb43-35"><a href="#cb43-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-36"><a href="#cb43-36" aria-hidden="true" tabindex="-1"></a>n_features_selected <span class="op">=</span> (<span class="bu">abs</span>(best_elasticnet.coef_) <span class="op">&gt;</span> <span class="fl">0.0001</span>).<span class="bu">sum</span>()</span>
<span id="cb43-37"><a href="#cb43-37" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Caracter√≠sticas seleccionadas: </span><span class="sc">{</span>n_features_selected<span class="sc">}</span><span class="ss"> de </span><span class="sc">{</span><span class="bu">len</span>(X.columns)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb43-38"><a href="#cb43-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-39"><a href="#cb43-39" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">üìà M√©tricas de Rendimiento:"</span>)</span>
<span id="cb43-40"><a href="#cb43-40" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">" "</span><span class="op">*</span><span class="dv">20</span> <span class="op">+</span> <span class="st">"Train        Test"</span>)</span>
<span id="cb43-41"><a href="#cb43-41" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">50</span>)</span>
<span id="cb43-42"><a href="#cb43-42" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="st">'RMSE'</span><span class="sc">:&lt;20}</span><span class="ss"> </span><span class="sc">{</span>en_rmse_train<span class="sc">:&gt;10.4f}</span><span class="ss">   </span><span class="sc">{</span>en_rmse_test<span class="sc">:&gt;10.4f}</span><span class="ss">"</span>)</span>
<span id="cb43-43"><a href="#cb43-43" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="st">'MAE'</span><span class="sc">:&lt;20}</span><span class="ss"> </span><span class="sc">{</span>en_mae_train<span class="sc">:&gt;10.4f}</span><span class="ss">   </span><span class="sc">{</span>en_mae_test<span class="sc">:&gt;10.4f}</span><span class="ss">"</span>)</span>
<span id="cb43-44"><a href="#cb43-44" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="st">'R¬≤'</span><span class="sc">:&lt;20}</span><span class="ss"> </span><span class="sc">{</span>en_r2_train<span class="sc">:&gt;10.4f}</span><span class="ss">   </span><span class="sc">{</span>en_r2_test<span class="sc">:&gt;10.4f}</span><span class="ss">"</span>)</span>
<span id="cb43-45"><a href="#cb43-45" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="st">'MAPE (%)'</span><span class="sc">:&lt;20}</span><span class="ss"> </span><span class="sc">{</span><span class="st">''</span><span class="sc">:&gt;10}</span><span class="ss">   </span><span class="sc">{</span>en_mape_test<span class="sc">:&gt;10.2f}</span><span class="ss">"</span>)</span>
<span id="cb43-46"><a href="#cb43-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-47"><a href="#cb43-47" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">‚úÖ Evaluaci√≥n vs Criterios de √âxito:"</span>)</span>
<span id="cb43-48"><a href="#cb43-48" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   RMSE &lt; 0.5:  </span><span class="sc">{</span><span class="st">'‚úì CUMPLE'</span> <span class="cf">if</span> en_rmse_test <span class="op">&lt;</span> <span class="fl">0.5</span> <span class="cf">else</span> <span class="st">'‚úó NO CUMPLE'</span><span class="sc">}</span><span class="ss"> (actual: </span><span class="sc">{</span>en_rmse_test<span class="sc">:.4f}</span><span class="ss">)"</span>)</span>
<span id="cb43-49"><a href="#cb43-49" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   R¬≤ &gt; 0.70:   </span><span class="sc">{</span><span class="st">'‚úì CUMPLE'</span> <span class="cf">if</span> en_r2_test <span class="op">&gt;</span> <span class="fl">0.70</span> <span class="cf">else</span> <span class="st">'‚úó NO CUMPLE'</span><span class="sc">}</span><span class="ss"> (actual: </span><span class="sc">{</span>en_r2_test<span class="sc">:.4f}</span><span class="ss">)"</span>)</span>
<span id="cb43-50"><a href="#cb43-50" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   MAE &lt; 0.4:   </span><span class="sc">{</span><span class="st">'‚úì CUMPLE'</span> <span class="cf">if</span> en_mae_test <span class="op">&lt;</span> <span class="fl">0.4</span> <span class="cf">else</span> <span class="st">'‚úó NO CUMPLE'</span><span class="sc">}</span><span class="ss"> (actual: </span><span class="sc">{</span>en_mae_test<span class="sc">:.4f}</span><span class="ss">)"</span>)</span>
<span id="cb43-51"><a href="#cb43-51" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   MAPE &lt; 15%:  </span><span class="sc">{</span><span class="st">'‚úì CUMPLE'</span> <span class="cf">if</span> en_mape_test <span class="op">&lt;</span> <span class="dv">15</span> <span class="cf">else</span> <span class="st">'‚úó NO CUMPLE'</span><span class="sc">}</span><span class="ss"> (actual: </span><span class="sc">{</span>en_mape_test<span class="sc">:.2f}</span><span class="ss">%)"</span>)</span>
<span id="cb43-52"><a href="#cb43-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-53"><a href="#cb43-53" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">üí¨ Comparaci√≥n con Regresi√≥n Lineal:"</span>)</span>
<span id="cb43-54"><a href="#cb43-54" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   Diferencia en RMSE test: </span><span class="sc">{</span>en_rmse_test <span class="op">-</span> lr_rmse_test<span class="sc">:+.4f}</span><span class="ss">"</span>)</span>
<span id="cb43-55"><a href="#cb43-55" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   Diferencia en R¬≤ test: </span><span class="sc">{</span>en_r2_test <span class="op">-</span> lr_r2_test<span class="sc">:+.4f}</span><span class="ss">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
ELASTIC NET REGRESSION
======================================================================

Hiperpar√°metros: alpha=0.001, l1_ratio=0.9

üìä Coeficientes del modelo:

Caracter√≠stica    Coeficiente    Status
------------------------------------------------------------
Latitude            -0.885673    Activa
Longitude           -0.857994    Activa
MedInc               0.849584    Activa
AveBedrms            0.326979    Activa
AveRooms            -0.282283    Activa
HouseAge             0.123394    Activa
AveOccup            -0.039990    Activa
Population          -0.001145    Activa

Caracter√≠sticas seleccionadas: 8 de 8

üìà M√©tricas de Rendimiento:

                    Train        Test
--------------------------------------------------
RMSE                     0.7197       0.7447
MAE                      0.5287       0.5331
R¬≤                       0.6125       0.5768
MAPE (%)                               31.94

‚úÖ Evaluaci√≥n vs Criterios de √âxito:
   RMSE &lt; 0.5:  ‚úó NO CUMPLE (actual: 0.7447)
   R¬≤ &gt; 0.70:   ‚úó NO CUMPLE (actual: 0.5768)
   MAE &lt; 0.4:   ‚úó NO CUMPLE (actual: 0.5331)
   MAPE &lt; 15%:  ‚úó NO CUMPLE (actual: 31.94%)

üí¨ Comparaci√≥n con Regresi√≥n Lineal:
   Diferencia en RMSE test: -0.0009
   Diferencia en R¬≤ test: +0.0010</code></pre>
</div>
</div>
</section>
</section>
<section id="modelado-2-√°rbol-de-decisi√≥n" class="level2">
<h2 class="anchored" data-anchor-id="modelado-2-√°rbol-de-decisi√≥n">7. Modelado 2: √Årbol de Decisi√≥n</h2>
<p>Ahora exploramos modelos no lineales comenzando con un √°rbol de decisi√≥n individual.</p>
<div id="cell-40" class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># √Årbol de Decisi√≥n con b√∫squeda de hiperpar√°metros</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Nota: Usamos datos SIN escalar porque los √°rboles son invariantes a escalado</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Entrenando Decision Tree con GridSearchCV..."</span>)</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Esto puede tomar algunos minutos...</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Definir grilla de hiperpar√°metros</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>param_grid_tree <span class="op">=</span> {</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'max_depth'</span>: [<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>, <span class="va">None</span>],</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'min_samples_split'</span>: [<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">20</span>],</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'min_samples_leaf'</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">8</span>]</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a><span class="co"># GridSearchCV con 5-fold cross-validation</span></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>tree <span class="op">=</span> DecisionTreeRegressor(random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>grid_tree <span class="op">=</span> GridSearchCV(</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>    tree,</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>    param_grid_tree,</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>    cv<span class="op">=</span><span class="dv">5</span>,</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>    scoring<span class="op">=</span><span class="st">'neg_root_mean_squared_error'</span>,</span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>    n_jobs<span class="op">=-</span><span class="dv">1</span>,</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>    verbose<span class="op">=</span><span class="dv">1</span></span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>grid_tree.fit(X_train, y_train)</span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">‚úì B√∫squeda completada"</span>)</span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Mejores hiperpar√°metros encontrados:"</span>)</span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> param, value <span class="kw">in</span> grid_tree.best_params_.items():</span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  </span><span class="sc">{</span>param<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>value<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Mejor RMSE en validaci√≥n cruzada: </span><span class="sc">{</span><span class="op">-</span>grid_tree<span class="sc">.</span>best_score_<span class="sc">:.4f}</span><span class="ss">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Entrenando Decision Tree con GridSearchCV...
Esto puede tomar algunos minutos...

Fitting 5 folds for each of 80 candidates, totalling 400 fits

‚úì B√∫squeda completada

Mejores hiperpar√°metros encontrados:
  max_depth: 15
  min_samples_leaf: 8
  min_samples_split: 20

Mejor RMSE en validaci√≥n cruzada: 0.6114</code></pre>
</div>
</div>
<div id="cell-41" class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mejor modelo de √°rbol</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>best_tree <span class="op">=</span> grid_tree.best_estimator_</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicciones</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>y_pred_tree_train <span class="op">=</span> best_tree.predict(X_train)</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>y_pred_tree_test <span class="op">=</span> best_tree.predict(X_test)</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="co"># M√©tricas</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>tree_rmse_train <span class="op">=</span> np.sqrt(mean_squared_error(y_train, y_pred_tree_train))</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>tree_rmse_test <span class="op">=</span> np.sqrt(mean_squared_error(y_test, y_pred_tree_test))</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>tree_mae_train <span class="op">=</span> mean_absolute_error(y_train, y_pred_tree_train)</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>tree_mae_test <span class="op">=</span> mean_absolute_error(y_test, y_pred_tree_test)</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>tree_r2_train <span class="op">=</span> r2_score(y_train, y_pred_tree_train)</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>tree_r2_test <span class="op">=</span> r2_score(y_test, y_pred_tree_test)</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>tree_mape_test <span class="op">=</span> calculate_mape(y_test, y_pred_tree_test)</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"√ÅRBOL DE DECISI√ìN"</span>)</span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Hiperpar√°metros √≥ptimos:"</span>)</span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> param, value <span class="kw">in</span> grid_tree.best_params_.items():</span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  </span><span class="sc">{</span>param<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>value<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Caracter√≠sticas del √°rbol:"</span>)</span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  N√∫mero de hojas: </span><span class="sc">{</span>best_tree<span class="sc">.</span>get_n_leaves()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Profundidad: </span><span class="sc">{</span>best_tree<span class="sc">.</span>get_depth()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">üìà M√©tricas de Rendimiento:"</span>)</span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">" "</span><span class="op">*</span><span class="dv">20</span> <span class="op">+</span> <span class="st">"Train        Test"</span>)</span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">50</span>)</span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="st">'RMSE'</span><span class="sc">:&lt;20}</span><span class="ss"> </span><span class="sc">{</span>tree_rmse_train<span class="sc">:&gt;10.4f}</span><span class="ss">   </span><span class="sc">{</span>tree_rmse_test<span class="sc">:&gt;10.4f}</span><span class="ss">"</span>)</span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="st">'MAE'</span><span class="sc">:&lt;20}</span><span class="ss"> </span><span class="sc">{</span>tree_mae_train<span class="sc">:&gt;10.4f}</span><span class="ss">   </span><span class="sc">{</span>tree_mae_test<span class="sc">:&gt;10.4f}</span><span class="ss">"</span>)</span>
<span id="cb47-33"><a href="#cb47-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="st">'R¬≤'</span><span class="sc">:&lt;20}</span><span class="ss"> </span><span class="sc">{</span>tree_r2_train<span class="sc">:&gt;10.4f}</span><span class="ss">   </span><span class="sc">{</span>tree_r2_test<span class="sc">:&gt;10.4f}</span><span class="ss">"</span>)</span>
<span id="cb47-34"><a href="#cb47-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="st">'MAPE (%)'</span><span class="sc">:&lt;20}</span><span class="ss"> </span><span class="sc">{</span><span class="st">''</span><span class="sc">:&gt;10}</span><span class="ss">   </span><span class="sc">{</span>tree_mape_test<span class="sc">:&gt;10.2f}</span><span class="ss">"</span>)</span>
<span id="cb47-35"><a href="#cb47-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-36"><a href="#cb47-36" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">‚ö†Ô∏è  An√°lisis de Overfitting:"</span>)</span>
<span id="cb47-37"><a href="#cb47-37" aria-hidden="true" tabindex="-1"></a>overfitting <span class="op">=</span> tree_r2_train <span class="op">-</span> tree_r2_test</span>
<span id="cb47-38"><a href="#cb47-38" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   Diferencia R¬≤ (train - test): </span><span class="sc">{</span>overfitting<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb47-39"><a href="#cb47-39" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> overfitting <span class="op">&gt;</span> <span class="fl">0.1</span>:</span>
<span id="cb47-40"><a href="#cb47-40" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"   ‚ö†Ô∏è Hay evidencia de overfitting (diferencia &gt; 0.1)"</span>)</span>
<span id="cb47-41"><a href="#cb47-41" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb47-42"><a href="#cb47-42" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"   ‚úì Overfitting controlado"</span>)</span>
<span id="cb47-43"><a href="#cb47-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-44"><a href="#cb47-44" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">‚úÖ Evaluaci√≥n vs Criterios de √âxito:"</span>)</span>
<span id="cb47-45"><a href="#cb47-45" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   RMSE &lt; 0.5:  </span><span class="sc">{</span><span class="st">'‚úì CUMPLE'</span> <span class="cf">if</span> tree_rmse_test <span class="op">&lt;</span> <span class="fl">0.5</span> <span class="cf">else</span> <span class="st">'‚úó NO CUMPLE'</span><span class="sc">}</span><span class="ss"> (actual: </span><span class="sc">{</span>tree_rmse_test<span class="sc">:.4f}</span><span class="ss">)"</span>)</span>
<span id="cb47-46"><a href="#cb47-46" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   R¬≤ &gt; 0.70:   </span><span class="sc">{</span><span class="st">'‚úì CUMPLE'</span> <span class="cf">if</span> tree_r2_test <span class="op">&gt;</span> <span class="fl">0.70</span> <span class="cf">else</span> <span class="st">'‚úó NO CUMPLE'</span><span class="sc">}</span><span class="ss"> (actual: </span><span class="sc">{</span>tree_r2_test<span class="sc">:.4f}</span><span class="ss">)"</span>)</span>
<span id="cb47-47"><a href="#cb47-47" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   MAE &lt; 0.4:   </span><span class="sc">{</span><span class="st">'‚úì CUMPLE'</span> <span class="cf">if</span> tree_mae_test <span class="op">&lt;</span> <span class="fl">0.4</span> <span class="cf">else</span> <span class="st">'‚úó NO CUMPLE'</span><span class="sc">}</span><span class="ss"> (actual: </span><span class="sc">{</span>tree_mae_test<span class="sc">:.4f}</span><span class="ss">)"</span>)</span>
<span id="cb47-48"><a href="#cb47-48" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   MAPE &lt; 15%:  </span><span class="sc">{</span><span class="st">'‚úì CUMPLE'</span> <span class="cf">if</span> tree_mape_test <span class="op">&lt;</span> <span class="dv">15</span> <span class="cf">else</span> <span class="st">'‚úó NO CUMPLE'</span><span class="sc">}</span><span class="ss"> (actual: </span><span class="sc">{</span>tree_mape_test<span class="sc">:.2f}</span><span class="ss">%)"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
√ÅRBOL DE DECISI√ìN
======================================================================

Hiperpar√°metros √≥ptimos:
  max_depth: 15
  min_samples_leaf: 8
  min_samples_split: 20

Caracter√≠sticas del √°rbol:
  N√∫mero de hojas: 1239
  Profundidad: 15

üìà M√©tricas de Rendimiento:

                    Train        Test
--------------------------------------------------
RMSE                     0.4295       0.6058
MAE                      0.2830       0.4052
R¬≤                       0.8620       0.7200
MAPE (%)                               22.96

‚ö†Ô∏è  An√°lisis de Overfitting:
   Diferencia R¬≤ (train - test): 0.1420
   ‚ö†Ô∏è Hay evidencia de overfitting (diferencia &gt; 0.1)

‚úÖ Evaluaci√≥n vs Criterios de √âxito:
   RMSE &lt; 0.5:  ‚úó NO CUMPLE (actual: 0.6058)
   R¬≤ &gt; 0.70:   ‚úì CUMPLE (actual: 0.7200)
   MAE &lt; 0.4:   ‚úó NO CUMPLE (actual: 0.4052)
   MAPE &lt; 15%:  ‚úó NO CUMPLE (actual: 22.96%)</code></pre>
</div>
</div>
<div id="cell-42" class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Feature importance del √°rbol</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>feature_importance_tree <span class="op">=</span> pd.DataFrame({</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Caracter√≠stica'</span>: X.columns,</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Importancia'</span>: best_tree.feature_importances_</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>}).sort_values(<span class="st">'Importancia'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">üìä Importancia de Caracter√≠sticas (Decision Tree):</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(feature_importance_tree.to_string(index<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualizaci√≥n</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>bars <span class="op">=</span> ax.barh(feature_importance_tree[<span class="st">'Caracter√≠stica'</span>], </span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>               feature_importance_tree[<span class="st">'Importancia'</span>],</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>               color<span class="op">=</span><span class="st">'steelblue'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Importancia'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Importancia de Caracter√≠sticas - √Årbol de Decisi√≥n'</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>ax.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>, axis<span class="op">=</span><span class="st">'x'</span>)</span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a><span class="co"># A√±adir valores</span></span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> bar <span class="kw">in</span> bars:</span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>    width <span class="op">=</span> bar.get_width()</span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a>    ax.text(width, bar.get_y() <span class="op">+</span> bar.get_height()<span class="op">/</span><span class="dv">2</span>, <span class="ss">f'</span><span class="sc">{</span>width<span class="sc">:.3f}</span><span class="ss">'</span>,</span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a>            ha<span class="op">=</span><span class="st">'left'</span>, va<span class="op">=</span><span class="st">'center'</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
üìä Importancia de Caracter√≠sticas (Decision Tree):

Caracter√≠stica  Importancia
        MedInc     0.592857
      AveOccup     0.130724
      Latitude     0.087879
     Longitude     0.075680
      HouseAge     0.047571
      AveRooms     0.039311
     AveBedrms     0.014111
    Population     0.011867</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="california_housing_case_study_files/figure-html/cell-26-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="modelado-3-random-forest" class="level2">
<h2 class="anchored" data-anchor-id="modelado-3-random-forest">8. Modelado 3: Random Forest</h2>
<p>Random Forest usa m√∫ltiples √°rboles (ensemble) para reducir overfitting y mejorar predicciones.</p>
<div id="cell-44" class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Random Forest con b√∫squeda de hiperpar√°metros</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Entrenando Random Forest con GridSearchCV..."</span>)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Esto puede tomar varios minutos...</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Definir grilla de hiperpar√°metros (m√°s conservadora para tiempo de c√≥mputo)</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>param_grid_rf <span class="op">=</span> {</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'n_estimators'</span>: [<span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">300</span>],</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'max_depth'</span>: [<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>],</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'min_samples_split'</span>: [<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">10</span>],</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'min_samples_leaf'</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>]</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a><span class="co"># GridSearchCV con 2-fold cross-validation</span></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>rf <span class="op">=</span> RandomForestRegressor(random_state<span class="op">=</span><span class="dv">42</span>, n_jobs<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>grid_rf <span class="op">=</span> GridSearchCV(</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>    rf,</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>    param_grid_rf,</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>    cv<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>    scoring<span class="op">=</span><span class="st">'neg_root_mean_squared_error'</span>,</span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>    n_jobs<span class="op">=-</span><span class="dv">1</span>,</span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>    verbose<span class="op">=</span><span class="dv">1</span></span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a>grid_rf.fit(X_train, y_train)</span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">‚úì B√∫squeda completada"</span>)</span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Mejores hiperpar√°metros encontrados:"</span>)</span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> param, value <span class="kw">in</span> grid_rf.best_params_.items():</span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  </span><span class="sc">{</span>param<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>value<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Mejor RMSE en validaci√≥n cruzada: </span><span class="sc">{</span><span class="op">-</span>grid_rf<span class="sc">.</span>best_score_<span class="sc">:.4f}</span><span class="ss">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Entrenando Random Forest con GridSearchCV...
Esto puede tomar varios minutos...

Fitting 2 folds for each of 81 candidates, totalling 162 fits

‚úì B√∫squeda completada

Mejores hiperpar√°metros encontrados:
  max_depth: 30
  min_samples_leaf: 2
  min_samples_split: 2
  n_estimators: 300

Mejor RMSE en validaci√≥n cruzada: 0.5292</code></pre>
</div>
</div>
<div id="cell-45" class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mejor modelo Random Forest</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>best_rf <span class="op">=</span> grid_rf.best_estimator_</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicciones</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>y_pred_rf_train <span class="op">=</span> best_rf.predict(X_train)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>y_pred_rf_test <span class="op">=</span> best_rf.predict(X_test)</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a><span class="co"># M√©tricas</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>rf_rmse_train <span class="op">=</span> np.sqrt(mean_squared_error(y_train, y_pred_rf_train))</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>rf_rmse_test <span class="op">=</span> np.sqrt(mean_squared_error(y_test, y_pred_rf_test))</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>rf_mae_train <span class="op">=</span> mean_absolute_error(y_train, y_pred_rf_train)</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>rf_mae_test <span class="op">=</span> mean_absolute_error(y_test, y_pred_rf_test)</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>rf_r2_train <span class="op">=</span> r2_score(y_train, y_pred_rf_train)</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>rf_r2_test <span class="op">=</span> r2_score(y_test, y_pred_rf_test)</span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>rf_mape_test <span class="op">=</span> calculate_mape(y_test, y_pred_rf_test)</span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"RANDOM FOREST"</span>)</span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Hiperpar√°metros √≥ptimos:"</span>)</span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> param, value <span class="kw">in</span> grid_rf.best_params_.items():</span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  </span><span class="sc">{</span>param<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>value<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">üìà M√©tricas de Rendimiento:"</span>)</span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">" "</span><span class="op">*</span><span class="dv">20</span> <span class="op">+</span> <span class="st">"Train        Test"</span>)</span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">50</span>)</span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="st">'RMSE'</span><span class="sc">:&lt;20}</span><span class="ss"> </span><span class="sc">{</span>rf_rmse_train<span class="sc">:&gt;10.4f}</span><span class="ss">   </span><span class="sc">{</span>rf_rmse_test<span class="sc">:&gt;10.4f}</span><span class="ss">"</span>)</span>
<span id="cb53-28"><a href="#cb53-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="st">'MAE'</span><span class="sc">:&lt;20}</span><span class="ss"> </span><span class="sc">{</span>rf_mae_train<span class="sc">:&gt;10.4f}</span><span class="ss">   </span><span class="sc">{</span>rf_mae_test<span class="sc">:&gt;10.4f}</span><span class="ss">"</span>)</span>
<span id="cb53-29"><a href="#cb53-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="st">'R¬≤'</span><span class="sc">:&lt;20}</span><span class="ss"> </span><span class="sc">{</span>rf_r2_train<span class="sc">:&gt;10.4f}</span><span class="ss">   </span><span class="sc">{</span>rf_r2_test<span class="sc">:&gt;10.4f}</span><span class="ss">"</span>)</span>
<span id="cb53-30"><a href="#cb53-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="st">'MAPE (%)'</span><span class="sc">:&lt;20}</span><span class="ss"> </span><span class="sc">{</span><span class="st">''</span><span class="sc">:&gt;10}</span><span class="ss">   </span><span class="sc">{</span>rf_mape_test<span class="sc">:&gt;10.2f}</span><span class="ss">"</span>)</span>
<span id="cb53-31"><a href="#cb53-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-32"><a href="#cb53-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">‚ö†Ô∏è  An√°lisis de Overfitting:"</span>)</span>
<span id="cb53-33"><a href="#cb53-33" aria-hidden="true" tabindex="-1"></a>overfitting_rf <span class="op">=</span> rf_r2_train <span class="op">-</span> rf_r2_test</span>
<span id="cb53-34"><a href="#cb53-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   Diferencia R¬≤ (train - test): </span><span class="sc">{</span>overfitting_rf<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb53-35"><a href="#cb53-35" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> overfitting_rf <span class="op">&gt;</span> <span class="fl">0.1</span>:</span>
<span id="cb53-36"><a href="#cb53-36" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"   ‚ö†Ô∏è Hay evidencia de overfitting (diferencia &gt; 0.1)"</span>)</span>
<span id="cb53-37"><a href="#cb53-37" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb53-38"><a href="#cb53-38" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"   ‚úì Overfitting controlado"</span>)</span>
<span id="cb53-39"><a href="#cb53-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-40"><a href="#cb53-40" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">‚úÖ Evaluaci√≥n vs Criterios de √âxito:"</span>)</span>
<span id="cb53-41"><a href="#cb53-41" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   RMSE &lt; 0.5:  </span><span class="sc">{</span><span class="st">'‚úì CUMPLE'</span> <span class="cf">if</span> rf_rmse_test <span class="op">&lt;</span> <span class="fl">0.5</span> <span class="cf">else</span> <span class="st">'‚úó NO CUMPLE'</span><span class="sc">}</span><span class="ss"> (actual: </span><span class="sc">{</span>rf_rmse_test<span class="sc">:.4f}</span><span class="ss">)"</span>)</span>
<span id="cb53-42"><a href="#cb53-42" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   R¬≤ &gt; 0.70:   </span><span class="sc">{</span><span class="st">'‚úì CUMPLE'</span> <span class="cf">if</span> rf_r2_test <span class="op">&gt;</span> <span class="fl">0.70</span> <span class="cf">else</span> <span class="st">'‚úó NO CUMPLE'</span><span class="sc">}</span><span class="ss"> (actual: </span><span class="sc">{</span>rf_r2_test<span class="sc">:.4f}</span><span class="ss">)"</span>)</span>
<span id="cb53-43"><a href="#cb53-43" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   MAE &lt; 0.4:   </span><span class="sc">{</span><span class="st">'‚úì CUMPLE'</span> <span class="cf">if</span> rf_mae_test <span class="op">&lt;</span> <span class="fl">0.4</span> <span class="cf">else</span> <span class="st">'‚úó NO CUMPLE'</span><span class="sc">}</span><span class="ss"> (actual: </span><span class="sc">{</span>rf_mae_test<span class="sc">:.4f}</span><span class="ss">)"</span>)</span>
<span id="cb53-44"><a href="#cb53-44" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   MAPE &lt; 15%:  </span><span class="sc">{</span><span class="st">'‚úì CUMPLE'</span> <span class="cf">if</span> rf_mape_test <span class="op">&lt;</span> <span class="dv">15</span> <span class="cf">else</span> <span class="st">'‚úó NO CUMPLE'</span><span class="sc">}</span><span class="ss"> (actual: </span><span class="sc">{</span>rf_mape_test<span class="sc">:.2f}</span><span class="ss">%)"</span>)</span>
<span id="cb53-45"><a href="#cb53-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-46"><a href="#cb53-46" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">üí¨ Mejora sobre √Årbol Individual:"</span>)</span>
<span id="cb53-47"><a href="#cb53-47" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   Mejora en RMSE test: </span><span class="sc">{</span>tree_rmse_test <span class="op">-</span> rf_rmse_test<span class="sc">:.4f}</span><span class="ss"> (</span><span class="sc">{</span>(tree_rmse_test <span class="op">-</span> rf_rmse_test)<span class="op">/</span>tree_rmse_test<span class="op">*</span><span class="dv">100</span><span class="sc">:.1f}</span><span class="ss">%)"</span>)</span>
<span id="cb53-48"><a href="#cb53-48" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   Mejora en R¬≤ test: </span><span class="sc">{</span>rf_r2_test <span class="op">-</span> tree_r2_test<span class="sc">:+.4f}</span><span class="ss">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
RANDOM FOREST
======================================================================

Hiperpar√°metros √≥ptimos:
  max_depth: 30
  min_samples_leaf: 2
  min_samples_split: 2
  n_estimators: 300

üìà M√©tricas de Rendimiento:

                    Train        Test
--------------------------------------------------
RMSE                     0.2338       0.5038
MAE                      0.1436       0.3262
R¬≤                       0.9591       0.8063
MAPE (%)                               18.76

‚ö†Ô∏è  An√°lisis de Overfitting:
   Diferencia R¬≤ (train - test): 0.1528
   ‚ö†Ô∏è Hay evidencia de overfitting (diferencia &gt; 0.1)

‚úÖ Evaluaci√≥n vs Criterios de √âxito:
   RMSE &lt; 0.5:  ‚úó NO CUMPLE (actual: 0.5038)
   R¬≤ &gt; 0.70:   ‚úì CUMPLE (actual: 0.8063)
   MAE &lt; 0.4:   ‚úì CUMPLE (actual: 0.3262)
   MAPE &lt; 15%:  ‚úó NO CUMPLE (actual: 18.76%)

üí¨ Mejora sobre √Årbol Individual:
   Mejora en RMSE test: 0.1019 (16.8%)
   Mejora en R¬≤ test: +0.0863</code></pre>
</div>
</div>
<div id="cell-46" class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Feature importance de Random Forest</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>feature_importance_rf <span class="op">=</span> pd.DataFrame({</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Caracter√≠stica'</span>: X.columns,</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Importancia'</span>: best_rf.feature_importances_</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>}).sort_values(<span class="st">'Importancia'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">üìä Importancia de Caracter√≠sticas (Random Forest):</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(feature_importance_rf.to_string(index<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualizaci√≥n</span></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>bars <span class="op">=</span> ax.barh(feature_importance_rf[<span class="st">'Caracter√≠stica'</span>], </span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>               feature_importance_rf[<span class="st">'Importancia'</span>],</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>               color<span class="op">=</span><span class="st">'forestgreen'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Importancia'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Importancia de Caracter√≠sticas - Random Forest'</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>ax.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>, axis<span class="op">=</span><span class="st">'x'</span>)</span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a><span class="co"># A√±adir valores</span></span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> bar <span class="kw">in</span> bars:</span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a>    width <span class="op">=</span> bar.get_width()</span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a>    ax.text(width, bar.get_y() <span class="op">+</span> bar.get_height()<span class="op">/</span><span class="dv">2</span>, <span class="ss">f'</span><span class="sc">{</span>width<span class="sc">:.3f}</span><span class="ss">'</span>,</span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a>            ha<span class="op">=</span><span class="st">'left'</span>, va<span class="op">=</span><span class="st">'center'</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb55-26"><a href="#cb55-26" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb55-27"><a href="#cb55-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-28"><a href="#cb55-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">üí° Nota: Random Forest ofrece importancias m√°s estables que un √°rbol individual."</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
üìä Importancia de Caracter√≠sticas (Random Forest):

Caracter√≠stica  Importancia
        MedInc     0.535380
      AveOccup     0.138019
      Latitude     0.088226
     Longitude     0.088075
      HouseAge     0.053259
      AveRooms     0.042558
    Population     0.027862
     AveBedrms     0.026620</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="california_housing_case_study_files/figure-html/cell-29-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
üí° Nota: Random Forest ofrece importancias m√°s estables que un √°rbol individual.</code></pre>
</div>
</div>
</section>
<section id="modelado-4-xgboost" class="level2">
<h2 class="anchored" data-anchor-id="modelado-4-xgboost">9. Modelado 4: XGBoost</h2>
<p>XGBoost usa gradient boosting, construyendo √°rboles secuencialmente para corregir errores.</p>
<div id="cell-48" class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># XGBoost con b√∫squeda de hiperpar√°metros</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Entrenando XGBoost con GridSearchCV..."</span>)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Esto puede tomar varios minutos...</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Definir grilla de hiperpar√°metros</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>param_grid_xgb <span class="op">=</span> {</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'n_estimators'</span>: [<span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">300</span>],</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'max_depth'</span>: [<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>],</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'learning_rate'</span>: [<span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="fl">0.3</span>],</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'subsample'</span>: [<span class="fl">0.8</span>, <span class="fl">1.0</span>],</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'colsample_bytree'</span>: [<span class="fl">0.8</span>, <span class="fl">1.0</span>]</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a><span class="co"># GridSearchCV con 5-fold cross-validation</span></span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>xgb_model <span class="op">=</span> xgb.XGBRegressor(random_state<span class="op">=</span><span class="dv">42</span>, n_jobs<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>grid_xgb <span class="op">=</span> GridSearchCV(</span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>    xgb_model,</span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a>    param_grid_xgb,</span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a>    cv<span class="op">=</span><span class="dv">5</span>,</span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a>    scoring<span class="op">=</span><span class="st">'neg_root_mean_squared_error'</span>,</span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a>    n_jobs<span class="op">=-</span><span class="dv">1</span>,</span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a>    verbose<span class="op">=</span><span class="dv">1</span></span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb58-24"><a href="#cb58-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-25"><a href="#cb58-25" aria-hidden="true" tabindex="-1"></a>grid_xgb.fit(X_train, y_train)</span>
<span id="cb58-26"><a href="#cb58-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-27"><a href="#cb58-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">‚úì B√∫squeda completada"</span>)</span>
<span id="cb58-28"><a href="#cb58-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Mejores hiperpar√°metros encontrados:"</span>)</span>
<span id="cb58-29"><a href="#cb58-29" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> param, value <span class="kw">in</span> grid_xgb.best_params_.items():</span>
<span id="cb58-30"><a href="#cb58-30" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  </span><span class="sc">{</span>param<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>value<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb58-31"><a href="#cb58-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Mejor RMSE en validaci√≥n cruzada: </span><span class="sc">{</span><span class="op">-</span>grid_xgb<span class="sc">.</span>best_score_<span class="sc">:.4f}</span><span class="ss">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Entrenando XGBoost con GridSearchCV...
Esto puede tomar varios minutos...

Fitting 5 folds for each of 108 candidates, totalling 540 fits

‚úì B√∫squeda completada

Mejores hiperpar√°metros encontrados:
  colsample_bytree: 0.8
  learning_rate: 0.1
  max_depth: 7
  n_estimators: 300
  subsample: 1.0

Mejor RMSE en validaci√≥n cruzada: 0.4553</code></pre>
</div>
</div>
<div id="cell-49" class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mejor modelo XGBoost</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>best_xgb <span class="op">=</span> grid_xgb.best_estimator_</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicciones</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>y_pred_xgb_train <span class="op">=</span> best_xgb.predict(X_train)</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>y_pred_xgb_test <span class="op">=</span> best_xgb.predict(X_test)</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a><span class="co"># M√©tricas</span></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>xgb_rmse_train <span class="op">=</span> np.sqrt(mean_squared_error(y_train, y_pred_xgb_train))</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>xgb_rmse_test <span class="op">=</span> np.sqrt(mean_squared_error(y_test, y_pred_xgb_test))</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>xgb_mae_train <span class="op">=</span> mean_absolute_error(y_train, y_pred_xgb_train)</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>xgb_mae_test <span class="op">=</span> mean_absolute_error(y_test, y_pred_xgb_test)</span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>xgb_r2_train <span class="op">=</span> r2_score(y_train, y_pred_xgb_train)</span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>xgb_r2_test <span class="op">=</span> r2_score(y_test, y_pred_xgb_test)</span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>xgb_mape_test <span class="op">=</span> calculate_mape(y_test, y_pred_xgb_test)</span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"XGBOOST"</span>)</span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Hiperpar√°metros √≥ptimos:"</span>)</span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> param, value <span class="kw">in</span> grid_xgb.best_params_.items():</span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  </span><span class="sc">{</span>param<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>value<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">üìà M√©tricas de Rendimiento:"</span>)</span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">" "</span><span class="op">*</span><span class="dv">20</span> <span class="op">+</span> <span class="st">"Train        Test"</span>)</span>
<span id="cb60-26"><a href="#cb60-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">50</span>)</span>
<span id="cb60-27"><a href="#cb60-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="st">'RMSE'</span><span class="sc">:&lt;20}</span><span class="ss"> </span><span class="sc">{</span>xgb_rmse_train<span class="sc">:&gt;10.4f}</span><span class="ss">   </span><span class="sc">{</span>xgb_rmse_test<span class="sc">:&gt;10.4f}</span><span class="ss">"</span>)</span>
<span id="cb60-28"><a href="#cb60-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="st">'MAE'</span><span class="sc">:&lt;20}</span><span class="ss"> </span><span class="sc">{</span>xgb_mae_train<span class="sc">:&gt;10.4f}</span><span class="ss">   </span><span class="sc">{</span>xgb_mae_test<span class="sc">:&gt;10.4f}</span><span class="ss">"</span>)</span>
<span id="cb60-29"><a href="#cb60-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="st">'R¬≤'</span><span class="sc">:&lt;20}</span><span class="ss"> </span><span class="sc">{</span>xgb_r2_train<span class="sc">:&gt;10.4f}</span><span class="ss">   </span><span class="sc">{</span>xgb_r2_test<span class="sc">:&gt;10.4f}</span><span class="ss">"</span>)</span>
<span id="cb60-30"><a href="#cb60-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="st">'MAPE (%)'</span><span class="sc">:&lt;20}</span><span class="ss"> </span><span class="sc">{</span><span class="st">''</span><span class="sc">:&gt;10}</span><span class="ss">   </span><span class="sc">{</span>xgb_mape_test<span class="sc">:&gt;10.2f}</span><span class="ss">"</span>)</span>
<span id="cb60-31"><a href="#cb60-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-32"><a href="#cb60-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">‚ö†Ô∏è  An√°lisis de Overfitting:"</span>)</span>
<span id="cb60-33"><a href="#cb60-33" aria-hidden="true" tabindex="-1"></a>overfitting_xgb <span class="op">=</span> xgb_r2_train <span class="op">-</span> xgb_r2_test</span>
<span id="cb60-34"><a href="#cb60-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   Diferencia R¬≤ (train - test): </span><span class="sc">{</span>overfitting_xgb<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb60-35"><a href="#cb60-35" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> overfitting_xgb <span class="op">&gt;</span> <span class="fl">0.1</span>:</span>
<span id="cb60-36"><a href="#cb60-36" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"   ‚ö†Ô∏è Hay evidencia de overfitting (diferencia &gt; 0.1)"</span>)</span>
<span id="cb60-37"><a href="#cb60-37" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb60-38"><a href="#cb60-38" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"   ‚úì Overfitting controlado"</span>)</span>
<span id="cb60-39"><a href="#cb60-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-40"><a href="#cb60-40" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">‚úÖ Evaluaci√≥n vs Criterios de √âxito:"</span>)</span>
<span id="cb60-41"><a href="#cb60-41" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   RMSE &lt; 0.5:  </span><span class="sc">{</span><span class="st">'‚úì CUMPLE'</span> <span class="cf">if</span> xgb_rmse_test <span class="op">&lt;</span> <span class="fl">0.5</span> <span class="cf">else</span> <span class="st">'‚úó NO CUMPLE'</span><span class="sc">}</span><span class="ss"> (actual: </span><span class="sc">{</span>xgb_rmse_test<span class="sc">:.4f}</span><span class="ss">)"</span>)</span>
<span id="cb60-42"><a href="#cb60-42" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   R¬≤ &gt; 0.70:   </span><span class="sc">{</span><span class="st">'‚úì CUMPLE'</span> <span class="cf">if</span> xgb_r2_test <span class="op">&gt;</span> <span class="fl">0.70</span> <span class="cf">else</span> <span class="st">'‚úó NO CUMPLE'</span><span class="sc">}</span><span class="ss"> (actual: </span><span class="sc">{</span>xgb_r2_test<span class="sc">:.4f}</span><span class="ss">)"</span>)</span>
<span id="cb60-43"><a href="#cb60-43" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   MAE &lt; 0.4:   </span><span class="sc">{</span><span class="st">'‚úì CUMPLE'</span> <span class="cf">if</span> xgb_mae_test <span class="op">&lt;</span> <span class="fl">0.4</span> <span class="cf">else</span> <span class="st">'‚úó NO CUMPLE'</span><span class="sc">}</span><span class="ss"> (actual: </span><span class="sc">{</span>xgb_mae_test<span class="sc">:.4f}</span><span class="ss">)"</span>)</span>
<span id="cb60-44"><a href="#cb60-44" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   MAPE &lt; 15%:  </span><span class="sc">{</span><span class="st">'‚úì CUMPLE'</span> <span class="cf">if</span> xgb_mape_test <span class="op">&lt;</span> <span class="dv">15</span> <span class="cf">else</span> <span class="st">'‚úó NO CUMPLE'</span><span class="sc">}</span><span class="ss"> (actual: </span><span class="sc">{</span>xgb_mape_test<span class="sc">:.2f}</span><span class="ss">%)"</span>)</span>
<span id="cb60-45"><a href="#cb60-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-46"><a href="#cb60-46" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">üí¨ Mejora sobre Random Forest:"</span>)</span>
<span id="cb60-47"><a href="#cb60-47" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   Mejora en RMSE test: </span><span class="sc">{</span>rf_rmse_test <span class="op">-</span> xgb_rmse_test<span class="sc">:.4f}</span><span class="ss"> (</span><span class="sc">{</span>(rf_rmse_test <span class="op">-</span> xgb_rmse_test)<span class="op">/</span>rf_rmse_test<span class="op">*</span><span class="dv">100</span><span class="sc">:.1f}</span><span class="ss">%)"</span>)</span>
<span id="cb60-48"><a href="#cb60-48" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   Mejora en R¬≤ test: </span><span class="sc">{</span>xgb_r2_test <span class="op">-</span> rf_r2_test<span class="sc">:+.4f}</span><span class="ss">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
XGBOOST
======================================================================

Hiperpar√°metros √≥ptimos:
  colsample_bytree: 0.8
  learning_rate: 0.1
  max_depth: 7
  n_estimators: 300
  subsample: 1.0

üìà M√©tricas de Rendimiento:

                    Train        Test
--------------------------------------------------
RMSE                     0.1996       0.4428
MAE                      0.1411       0.2891
R¬≤                       0.9702       0.8504
MAPE (%)                               16.72

‚ö†Ô∏è  An√°lisis de Overfitting:
   Diferencia R¬≤ (train - test): 0.1198
   ‚ö†Ô∏è Hay evidencia de overfitting (diferencia &gt; 0.1)

‚úÖ Evaluaci√≥n vs Criterios de √âxito:
   RMSE &lt; 0.5:  ‚úì CUMPLE (actual: 0.4428)
   R¬≤ &gt; 0.70:   ‚úì CUMPLE (actual: 0.8504)
   MAE &lt; 0.4:   ‚úì CUMPLE (actual: 0.2891)
   MAPE &lt; 15%:  ‚úó NO CUMPLE (actual: 16.72%)

üí¨ Mejora sobre Random Forest:
   Mejora en RMSE test: 0.0611 (12.1%)
   Mejora en R¬≤ test: +0.0441</code></pre>
</div>
</div>
<div id="cell-50" class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Feature importance de XGBoost</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>feature_importance_xgb <span class="op">=</span> pd.DataFrame({</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Caracter√≠stica'</span>: X.columns,</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Importancia'</span>: best_xgb.feature_importances_</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>}).sort_values(<span class="st">'Importancia'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">üìä Importancia de Caracter√≠sticas (XGBoost):</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(feature_importance_xgb.to_string(index<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualizaci√≥n</span></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>bars <span class="op">=</span> ax.barh(feature_importance_xgb[<span class="st">'Caracter√≠stica'</span>], </span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>               feature_importance_xgb[<span class="st">'Importancia'</span>],</span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>               color<span class="op">=</span><span class="st">'darkviolet'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Importancia (F-score)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Importancia de Caracter√≠sticas - XGBoost'</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>ax.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>, axis<span class="op">=</span><span class="st">'x'</span>)</span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a><span class="co"># A√±adir valores</span></span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> bar <span class="kw">in</span> bars:</span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a>    width <span class="op">=</span> bar.get_width()</span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a>    ax.text(width, bar.get_y() <span class="op">+</span> bar.get_height()<span class="op">/</span><span class="dv">2</span>, <span class="ss">f'</span><span class="sc">{</span>width<span class="sc">:.3f}</span><span class="ss">'</span>,</span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a>            ha<span class="op">=</span><span class="st">'left'</span>, va<span class="op">=</span><span class="st">'center'</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-25"><a href="#cb62-25" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb62-26"><a href="#cb62-26" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
üìä Importancia de Caracter√≠sticas (XGBoost):

Caracter√≠stica  Importancia
        MedInc     0.373598
     Longitude     0.150309
      AveOccup     0.133131
      Latitude     0.132463
      AveRooms     0.088982
      HouseAge     0.056577
     AveBedrms     0.042199
    Population     0.022741</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="california_housing_case_study_files/figure-html/cell-32-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="comparaci√≥n-final-de-modelos-y-conclusiones" class="level2">
<h2 class="anchored" data-anchor-id="comparaci√≥n-final-de-modelos-y-conclusiones">10. Comparaci√≥n Final de Modelos y Conclusiones</h2>
<p>Ahora comparamos todos los modelos y evaluamos si cumplimos nuestros criterios de √©xito.</p>
<div id="cell-52" class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear tabla comparativa completa</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>comparison_df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Modelo'</span>: [<span class="st">'Baseline (Media)'</span>, <span class="st">'Linear Regression'</span>, <span class="st">'Elastic Net'</span>, <span class="st">'Decision Tree'</span>, <span class="st">'Random Forest'</span>, <span class="st">'XGBoost'</span>],</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'RMSE Train'</span>: [baseline_rmse, lr_rmse_train, en_rmse_train, tree_rmse_train, rf_rmse_train, xgb_rmse_train],</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'RMSE Test'</span>: [baseline_rmse, lr_rmse_test, en_rmse_test, tree_rmse_test, rf_rmse_test, xgb_rmse_test],</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MAE Train'</span>: [baseline_mae, lr_mae_train, en_mae_train, tree_mae_train, rf_mae_train, xgb_mae_train],</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MAE Test'</span>: [baseline_mae, lr_mae_test, en_mae_test, tree_mae_test, rf_mae_test, xgb_mae_test],</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'R¬≤ Train'</span>: [baseline_r2, lr_r2_train, en_r2_train, tree_r2_train, rf_r2_train, xgb_r2_train],</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'R¬≤ Test'</span>: [baseline_r2, lr_r2_test, en_r2_test, tree_r2_test, rf_r2_test, xgb_r2_test],</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MAPE Test (%)'</span>: [baseline_mape, lr_mape_test, en_mape_test, tree_mape_test, rf_mape_test, xgb_mape_test]</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">90</span>)</span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"TABLA COMPARATIVA FINAL - TODOS LOS MODELOS"</span>)</span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">90</span>)</span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(comparison_df.<span class="bu">round</span>(<span class="dv">4</span>).to_string(index<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Identificar el mejor modelo</span></span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a>best_model_idx <span class="op">=</span> comparison_df.iloc[<span class="dv">1</span>:][<span class="st">'RMSE Test'</span>].idxmin()  <span class="co"># Excluir baseline</span></span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a>best_model_name <span class="op">=</span> comparison_df.loc[best_model_idx, <span class="st">'Modelo'</span>]</span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a>best_rmse <span class="op">=</span> comparison_df.loc[best_model_idx, <span class="st">'RMSE Test'</span>]</span>
<span id="cb64-22"><a href="#cb64-22" aria-hidden="true" tabindex="-1"></a>best_r2 <span class="op">=</span> comparison_df.loc[best_model_idx, <span class="st">'R¬≤ Test'</span>]</span>
<span id="cb64-23"><a href="#cb64-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-24"><a href="#cb64-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">üèÜ MEJOR MODELO: </span><span class="sc">{</span>best_model_name<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb64-25"><a href="#cb64-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   RMSE Test: </span><span class="sc">{</span>best_rmse<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb64-26"><a href="#cb64-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   R¬≤ Test: </span><span class="sc">{</span>best_r2<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb64-27"><a href="#cb64-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">   Mejora sobre baseline: </span><span class="sc">{</span>(baseline_rmse <span class="op">-</span> best_rmse)<span class="op">/</span>baseline_rmse<span class="op">*</span><span class="dv">100</span><span class="sc">:.1f}</span><span class="ss">% reducci√≥n en RMSE"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>==========================================================================================
TABLA COMPARATIVA FINAL - TODOS LOS MODELOS
==========================================================================================
           Modelo  RMSE Train  RMSE Test  MAE Train  MAE Test  R¬≤ Train  R¬≤ Test  MAPE Test (%)
 Baseline (Media)      1.1449     1.1449     0.9061    0.9061   -0.0002  -0.0002        62.8861
Linear Regression      0.7197     0.7456     0.5286    0.5332    0.6126   0.5758        31.9522
      Elastic Net      0.7197     0.7447     0.5287    0.5331    0.6125   0.5768        31.9351
    Decision Tree      0.4295     0.6058     0.2830    0.4052    0.8620   0.7200        22.9639
    Random Forest      0.2338     0.5038     0.1436    0.3262    0.9591   0.8063        18.7641
          XGBoost      0.1996     0.4428     0.1411    0.2891    0.9702   0.8504        16.7151

üèÜ MEJOR MODELO: XGBoost
   RMSE Test: 0.4428
   R¬≤ Test: 0.8504

   Mejora sobre baseline: 61.3% reducci√≥n en RMSE</code></pre>
</div>
</div>
<div id="cell-53" class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualizaci√≥n comparativa de m√©tricas</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">16</span>, <span class="dv">12</span>))</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">'Comparaci√≥n de Rendimiento entre Modelos'</span>, fontsize<span class="op">=</span><span class="dv">18</span>, y<span class="op">=</span><span class="fl">0.995</span>)</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>models <span class="op">=</span> comparison_df[<span class="st">'Modelo'</span>].tolist()</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>x_pos <span class="op">=</span> np.arange(<span class="bu">len</span>(models))</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span> [<span class="st">'gray'</span>, <span class="st">'steelblue'</span>, <span class="st">'coral'</span>, <span class="st">'lightgreen'</span>, <span class="st">'forestgreen'</span>, <span class="st">'darkviolet'</span>]</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a><span class="co"># RMSE</span></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>ax1 <span class="op">=</span> axes[<span class="dv">0</span>, <span class="dv">0</span>]</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>width <span class="op">=</span> <span class="fl">0.35</span></span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>bars1 <span class="op">=</span> ax1.bar(x_pos <span class="op">-</span> width<span class="op">/</span><span class="dv">2</span>, comparison_df[<span class="st">'RMSE Train'</span>], width, label<span class="op">=</span><span class="st">'Train'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>bars2 <span class="op">=</span> ax1.bar(x_pos <span class="op">+</span> width<span class="op">/</span><span class="dv">2</span>, comparison_df[<span class="st">'RMSE Test'</span>], width, label<span class="op">=</span><span class="st">'Test'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">'RMSE'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'Root Mean Squared Error'</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>ax1.set_xticks(x_pos)</span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>ax1.set_xticklabels(models, rotation<span class="op">=</span><span class="dv">45</span>, ha<span class="op">=</span><span class="st">'right'</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>ax1.legend()</span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>ax1.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>, axis<span class="op">=</span><span class="st">'y'</span>)</span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>ax1.axhline(y<span class="op">=</span><span class="fl">0.5</span>, color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, label<span class="op">=</span><span class="st">'Objetivo: 0.5'</span>)</span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a><span class="co"># MAE</span></span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> axes[<span class="dv">0</span>, <span class="dv">1</span>]</span>
<span id="cb66-24"><a href="#cb66-24" aria-hidden="true" tabindex="-1"></a>bars3 <span class="op">=</span> ax2.bar(x_pos <span class="op">-</span> width<span class="op">/</span><span class="dv">2</span>, comparison_df[<span class="st">'MAE Train'</span>], width, label<span class="op">=</span><span class="st">'Train'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb66-25"><a href="#cb66-25" aria-hidden="true" tabindex="-1"></a>bars4 <span class="op">=</span> ax2.bar(x_pos <span class="op">+</span> width<span class="op">/</span><span class="dv">2</span>, comparison_df[<span class="st">'MAE Test'</span>], width, label<span class="op">=</span><span class="st">'Test'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb66-26"><a href="#cb66-26" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'MAE'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb66-27"><a href="#cb66-27" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'Mean Absolute Error'</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb66-28"><a href="#cb66-28" aria-hidden="true" tabindex="-1"></a>ax2.set_xticks(x_pos)</span>
<span id="cb66-29"><a href="#cb66-29" aria-hidden="true" tabindex="-1"></a>ax2.set_xticklabels(models, rotation<span class="op">=</span><span class="dv">45</span>, ha<span class="op">=</span><span class="st">'right'</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb66-30"><a href="#cb66-30" aria-hidden="true" tabindex="-1"></a>ax2.legend()</span>
<span id="cb66-31"><a href="#cb66-31" aria-hidden="true" tabindex="-1"></a>ax2.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>, axis<span class="op">=</span><span class="st">'y'</span>)</span>
<span id="cb66-32"><a href="#cb66-32" aria-hidden="true" tabindex="-1"></a>ax2.axhline(y<span class="op">=</span><span class="fl">0.4</span>, color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, label<span class="op">=</span><span class="st">'Objetivo: 0.4'</span>)</span>
<span id="cb66-33"><a href="#cb66-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-34"><a href="#cb66-34" aria-hidden="true" tabindex="-1"></a><span class="co"># R¬≤</span></span>
<span id="cb66-35"><a href="#cb66-35" aria-hidden="true" tabindex="-1"></a>ax3 <span class="op">=</span> axes[<span class="dv">1</span>, <span class="dv">0</span>]</span>
<span id="cb66-36"><a href="#cb66-36" aria-hidden="true" tabindex="-1"></a>bars5 <span class="op">=</span> ax3.bar(x_pos <span class="op">-</span> width<span class="op">/</span><span class="dv">2</span>, comparison_df[<span class="st">'R¬≤ Train'</span>], width, label<span class="op">=</span><span class="st">'Train'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb66-37"><a href="#cb66-37" aria-hidden="true" tabindex="-1"></a>bars6 <span class="op">=</span> ax3.bar(x_pos <span class="op">+</span> width<span class="op">/</span><span class="dv">2</span>, comparison_df[<span class="st">'R¬≤ Test'</span>], width, label<span class="op">=</span><span class="st">'Test'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb66-38"><a href="#cb66-38" aria-hidden="true" tabindex="-1"></a>ax3.set_ylabel(<span class="st">'R¬≤'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb66-39"><a href="#cb66-39" aria-hidden="true" tabindex="-1"></a>ax3.set_title(<span class="st">'Coeficiente de Determinaci√≥n (R¬≤)'</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb66-40"><a href="#cb66-40" aria-hidden="true" tabindex="-1"></a>ax3.set_xticks(x_pos)</span>
<span id="cb66-41"><a href="#cb66-41" aria-hidden="true" tabindex="-1"></a>ax3.set_xticklabels(models, rotation<span class="op">=</span><span class="dv">45</span>, ha<span class="op">=</span><span class="st">'right'</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb66-42"><a href="#cb66-42" aria-hidden="true" tabindex="-1"></a>ax3.legend()</span>
<span id="cb66-43"><a href="#cb66-43" aria-hidden="true" tabindex="-1"></a>ax3.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>, axis<span class="op">=</span><span class="st">'y'</span>)</span>
<span id="cb66-44"><a href="#cb66-44" aria-hidden="true" tabindex="-1"></a>ax3.axhline(y<span class="op">=</span><span class="fl">0.7</span>, color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, label<span class="op">=</span><span class="st">'Objetivo: 0.7'</span>)</span>
<span id="cb66-45"><a href="#cb66-45" aria-hidden="true" tabindex="-1"></a>ax3.set_ylim([<span class="op">-</span><span class="fl">0.1</span>, <span class="fl">1.0</span>])</span>
<span id="cb66-46"><a href="#cb66-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-47"><a href="#cb66-47" aria-hidden="true" tabindex="-1"></a><span class="co"># MAPE</span></span>
<span id="cb66-48"><a href="#cb66-48" aria-hidden="true" tabindex="-1"></a>ax4 <span class="op">=</span> axes[<span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb66-49"><a href="#cb66-49" aria-hidden="true" tabindex="-1"></a>bars7 <span class="op">=</span> ax4.bar(x_pos, comparison_df[<span class="st">'MAPE Test (%)'</span>], color<span class="op">=</span>colors, alpha<span class="op">=</span><span class="fl">0.7</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb66-50"><a href="#cb66-50" aria-hidden="true" tabindex="-1"></a>ax4.set_ylabel(<span class="st">'MAPE (%)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb66-51"><a href="#cb66-51" aria-hidden="true" tabindex="-1"></a>ax4.set_title(<span class="st">'Mean Absolute Percentage Error (Test)'</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb66-52"><a href="#cb66-52" aria-hidden="true" tabindex="-1"></a>ax4.set_xticks(x_pos)</span>
<span id="cb66-53"><a href="#cb66-53" aria-hidden="true" tabindex="-1"></a>ax4.set_xticklabels(models, rotation<span class="op">=</span><span class="dv">45</span>, ha<span class="op">=</span><span class="st">'right'</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb66-54"><a href="#cb66-54" aria-hidden="true" tabindex="-1"></a>ax4.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>, axis<span class="op">=</span><span class="st">'y'</span>)</span>
<span id="cb66-55"><a href="#cb66-55" aria-hidden="true" tabindex="-1"></a>ax4.axhline(y<span class="op">=</span><span class="dv">15</span>, color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, label<span class="op">=</span><span class="st">'Objetivo: 15%'</span>)</span>
<span id="cb66-56"><a href="#cb66-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-57"><a href="#cb66-57" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb66-58"><a href="#cb66-58" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="california_housing_case_study_files/figure-html/cell-34-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-54" class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicciones vs Valores Reales - Todos los modelos</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">12</span>))</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">'Predicciones vs Valores Reales (Conjunto de Prueba)'</span>, fontsize<span class="op">=</span><span class="dv">18</span>, y<span class="op">=</span><span class="fl">0.995</span>)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>predictions_dict <span class="op">=</span> {</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Baseline'</span>: y_pred_baseline,</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Linear Regression'</span>: y_pred_lr_test,</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Elastic Net'</span>: y_pred_en_test,</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Decision Tree'</span>: y_pred_tree_test,</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Random Forest'</span>: y_pred_rf_test,</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'XGBoost'</span>: y_pred_xgb_test</span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ax, (name, predictions) <span class="kw">in</span> <span class="bu">zip</span>(axes.flat, predictions_dict.items()):</span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a>    ax.scatter(y_test, predictions, alpha<span class="op">=</span><span class="fl">0.4</span>, s<span class="op">=</span><span class="dv">15</span>, edgecolors<span class="op">=</span><span class="st">'none'</span>)</span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># L√≠nea de predicci√≥n perfecta</span></span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a>    min_val <span class="op">=</span> <span class="bu">min</span>(y_test.<span class="bu">min</span>(), predictions.<span class="bu">min</span>())</span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a>    max_val <span class="op">=</span> <span class="bu">max</span>(y_test.<span class="bu">max</span>(), predictions.<span class="bu">max</span>())</span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a>    ax.plot([min_val, max_val], [min_val, max_val], <span class="st">'r--'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">'Predicci√≥n Perfecta'</span>)</span>
<span id="cb67-21"><a href="#cb67-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb67-22"><a href="#cb67-22" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(<span class="st">'Valores Reales ($100k)'</span>, fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb67-23"><a href="#cb67-23" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(<span class="st">'Predicciones ($100k)'</span>, fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb67-24"><a href="#cb67-24" aria-hidden="true" tabindex="-1"></a>    ax.set_title(name, fontsize<span class="op">=</span><span class="dv">13</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb67-25"><a href="#cb67-25" aria-hidden="true" tabindex="-1"></a>    ax.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb67-26"><a href="#cb67-26" aria-hidden="true" tabindex="-1"></a>    ax.legend()</span>
<span id="cb67-27"><a href="#cb67-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb67-28"><a href="#cb67-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Agregar m√©tricas</span></span>
<span id="cb67-29"><a href="#cb67-29" aria-hidden="true" tabindex="-1"></a>    r2 <span class="op">=</span> r2_score(y_test, predictions)</span>
<span id="cb67-30"><a href="#cb67-30" aria-hidden="true" tabindex="-1"></a>    rmse <span class="op">=</span> np.sqrt(mean_squared_error(y_test, predictions))</span>
<span id="cb67-31"><a href="#cb67-31" aria-hidden="true" tabindex="-1"></a>    text_str <span class="op">=</span> <span class="ss">f'R¬≤ = </span><span class="sc">{</span>r2<span class="sc">:.4f}</span><span class="ch">\n</span><span class="ss">RMSE = </span><span class="sc">{</span>rmse<span class="sc">:.4f}</span><span class="ss">'</span></span>
<span id="cb67-32"><a href="#cb67-32" aria-hidden="true" tabindex="-1"></a>    ax.text(<span class="fl">0.05</span>, <span class="fl">0.95</span>, text_str, transform<span class="op">=</span>ax.transAxes,</span>
<span id="cb67-33"><a href="#cb67-33" aria-hidden="true" tabindex="-1"></a>            fontsize<span class="op">=</span><span class="dv">10</span>, verticalalignment<span class="op">=</span><span class="st">'top'</span>,</span>
<span id="cb67-34"><a href="#cb67-34" aria-hidden="true" tabindex="-1"></a>            bbox<span class="op">=</span><span class="bu">dict</span>(boxstyle<span class="op">=</span><span class="st">'round'</span>, facecolor<span class="op">=</span><span class="st">'white'</span>, alpha<span class="op">=</span><span class="fl">0.8</span>))</span>
<span id="cb67-35"><a href="#cb67-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-36"><a href="#cb67-36" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb67-37"><a href="#cb67-37" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="california_housing_case_study_files/figure-html/cell-35-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-55" class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># An√°lisis de residuos para los mejores 3 modelos</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">10</span>))</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">'An√°lisis de Residuos - Mejores Modelos'</span>, fontsize<span class="op">=</span><span class="dv">16</span>, y<span class="op">=</span><span class="fl">0.995</span>)</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>best_models_preds <span class="op">=</span> {</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Decision Tree'</span>: y_pred_tree_test,</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Random Forest'</span>: y_pred_rf_test,</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'XGBoost'</span>: y_pred_xgb_test</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx, (name, predictions) <span class="kw">in</span> <span class="bu">enumerate</span>(best_models_preds.items()):</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>    residuals <span class="op">=</span> y_test <span class="op">-</span> predictions</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Residuos vs Predicciones</span></span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>    ax1 <span class="op">=</span> axes[<span class="dv">0</span>, idx]</span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>    ax1.scatter(predictions, residuals, alpha<span class="op">=</span><span class="fl">0.4</span>, s<span class="op">=</span><span class="dv">15</span>, edgecolors<span class="op">=</span><span class="st">'none'</span>)</span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>    ax1.axhline(y<span class="op">=</span><span class="dv">0</span>, color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a>    ax1.set_xlabel(<span class="st">'Predicciones'</span>, fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a>    ax1.set_ylabel(<span class="st">'Residuos'</span>, fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a>    ax1.set_title(<span class="ss">f'</span><span class="sc">{</span>name<span class="sc">}</span><span class="ch">\n</span><span class="ss">Residuos vs Predicciones'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a>    ax1.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb68-23"><a href="#cb68-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Histograma de residuos</span></span>
<span id="cb68-24"><a href="#cb68-24" aria-hidden="true" tabindex="-1"></a>    ax2 <span class="op">=</span> axes[<span class="dv">1</span>, idx]</span>
<span id="cb68-25"><a href="#cb68-25" aria-hidden="true" tabindex="-1"></a>    ax2.hist(residuals, bins<span class="op">=</span><span class="dv">50</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb68-26"><a href="#cb68-26" aria-hidden="true" tabindex="-1"></a>    ax2.set_xlabel(<span class="st">'Residuos'</span>, fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb68-27"><a href="#cb68-27" aria-hidden="true" tabindex="-1"></a>    ax2.set_ylabel(<span class="st">'Frecuencia'</span>, fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb68-28"><a href="#cb68-28" aria-hidden="true" tabindex="-1"></a>    ax2.set_title(<span class="ss">f'</span><span class="sc">{</span>name<span class="sc">}</span><span class="ch">\n</span><span class="ss">Distribuci√≥n de Residuos'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb68-29"><a href="#cb68-29" aria-hidden="true" tabindex="-1"></a>    ax2.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>, axis<span class="op">=</span><span class="st">'y'</span>)</span>
<span id="cb68-30"><a href="#cb68-30" aria-hidden="true" tabindex="-1"></a>    ax2.axvline(<span class="dv">0</span>, color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb68-31"><a href="#cb68-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb68-32"><a href="#cb68-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Agregar estad√≠sticas</span></span>
<span id="cb68-33"><a href="#cb68-33" aria-hidden="true" tabindex="-1"></a>    mean_resid <span class="op">=</span> residuals.mean()</span>
<span id="cb68-34"><a href="#cb68-34" aria-hidden="true" tabindex="-1"></a>    std_resid <span class="op">=</span> residuals.std()</span>
<span id="cb68-35"><a href="#cb68-35" aria-hidden="true" tabindex="-1"></a>    ax2.text(<span class="fl">0.05</span>, <span class="fl">0.95</span>, <span class="ss">f'Media: </span><span class="sc">{</span>mean_resid<span class="sc">:.4f}</span><span class="ch">\n</span><span class="ss">Std: </span><span class="sc">{</span>std_resid<span class="sc">:.4f}</span><span class="ss">'</span>,</span>
<span id="cb68-36"><a href="#cb68-36" aria-hidden="true" tabindex="-1"></a>             transform<span class="op">=</span>ax2.transAxes, fontsize<span class="op">=</span><span class="dv">10</span>, verticalalignment<span class="op">=</span><span class="st">'top'</span>,</span>
<span id="cb68-37"><a href="#cb68-37" aria-hidden="true" tabindex="-1"></a>             bbox<span class="op">=</span><span class="bu">dict</span>(boxstyle<span class="op">=</span><span class="st">'round'</span>, facecolor<span class="op">=</span><span class="st">'white'</span>, alpha<span class="op">=</span><span class="fl">0.8</span>))</span>
<span id="cb68-38"><a href="#cb68-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-39"><a href="#cb68-39" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb68-40"><a href="#cb68-40" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb68-41"><a href="#cb68-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-42"><a href="#cb68-42" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">üìä Interpretaci√≥n de residuos:"</span>)</span>
<span id="cb68-43"><a href="#cb68-43" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   - Idealmente, los residuos deben estar centrados en 0"</span>)</span>
<span id="cb68-44"><a href="#cb68-44" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   - La distribuci√≥n debe ser aproximadamente normal"</span>)</span>
<span id="cb68-45"><a href="#cb68-45" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   - No debe haber patrones sistem√°ticos en el gr√°fico de residuos vs predicciones"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="california_housing_case_study_files/figure-html/cell-36-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
üìä Interpretaci√≥n de residuos:
   - Idealmente, los residuos deben estar centrados en 0
   - La distribuci√≥n debe ser aproximadamente normal
   - No debe haber patrones sistem√°ticos en el gr√°fico de residuos vs predicciones</code></pre>
</div>
</div>
</section>
<section id="conclusiones-y-recomendaciones" class="level2">
<h2 class="anchored" data-anchor-id="conclusiones-y-recomendaciones">Conclusiones y Recomendaciones</h2>
<section id="evaluaci√≥n-de-criterios-de-√©xito" class="level3">
<h3 class="anchored" data-anchor-id="evaluaci√≥n-de-criterios-de-√©xito">üéØ Evaluaci√≥n de Criterios de √âxito</h3>
<div id="cell-57" class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluar criterios de √©xito para todos los modelos</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">80</span>)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"EVALUACI√ìN DE CRITERIOS DE √âXITO"</span>)</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">80</span>)</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Criterios:"</span>)</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"  1. RMSE Test &lt; 0.5 ($50,000 USD)"</span>)</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"  2. R¬≤ Test &gt; 0.70 (70% varianza explicada)"</span>)</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"  3. MAE Test &lt; 0.4 ($40,000 USD)"</span>)</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"  4. MAPE Test &lt; 15%"</span>)</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"-"</span><span class="op">*</span><span class="dv">80</span>)</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="st">'Modelo'</span><span class="sc">:&lt;20}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'RMSE&lt;0.5'</span><span class="sc">:&lt;12}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'R¬≤&gt;0.70'</span><span class="sc">:&lt;12}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'MAE&lt;0.4'</span><span class="sc">:&lt;12}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'MAPE&lt;15%'</span><span class="sc">:&lt;12}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'Cumple Todo'</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span><span class="op">*</span><span class="dv">80</span>)</span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _, row <span class="kw">in</span> comparison_df.iloc[<span class="dv">1</span>:].iterrows():  <span class="co"># Excluir baseline</span></span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> row[<span class="st">'Modelo'</span>]</span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>    rmse_ok <span class="op">=</span> <span class="st">'‚úì'</span> <span class="cf">if</span> row[<span class="st">'RMSE Test'</span>] <span class="op">&lt;</span> <span class="fl">0.5</span> <span class="cf">else</span> <span class="st">'‚úó'</span></span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a>    r2_ok <span class="op">=</span> <span class="st">'‚úì'</span> <span class="cf">if</span> row[<span class="st">'R¬≤ Test'</span>] <span class="op">&gt;</span> <span class="fl">0.70</span> <span class="cf">else</span> <span class="st">'‚úó'</span></span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a>    mae_ok <span class="op">=</span> <span class="st">'‚úì'</span> <span class="cf">if</span> row[<span class="st">'MAE Test'</span>] <span class="op">&lt;</span> <span class="fl">0.4</span> <span class="cf">else</span> <span class="st">'‚úó'</span></span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a>    mape_ok <span class="op">=</span> <span class="st">'‚úì'</span> <span class="cf">if</span> row[<span class="st">'MAPE Test (%)'</span>] <span class="op">&lt;</span> <span class="dv">15</span> <span class="cf">else</span> <span class="st">'‚úó'</span></span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a>    all_ok <span class="op">=</span> <span class="st">'‚úì‚úì‚úì'</span> <span class="cf">if</span> <span class="bu">all</span>([rmse_ok<span class="op">==</span><span class="st">'‚úì'</span>, r2_ok<span class="op">==</span><span class="st">'‚úì'</span>, mae_ok<span class="op">==</span><span class="st">'‚úì'</span>, mape_ok<span class="op">==</span><span class="st">'‚úì'</span>]) <span class="cf">else</span> <span class="st">''</span></span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>model<span class="sc">:&lt;20}</span><span class="ss"> </span><span class="sc">{</span>rmse_ok<span class="sc">:&lt;12}</span><span class="ss"> </span><span class="sc">{</span>r2_ok<span class="sc">:&lt;12}</span><span class="ss"> </span><span class="sc">{</span>mae_ok<span class="sc">:&lt;12}</span><span class="ss"> </span><span class="sc">{</span>mape_ok<span class="sc">:&lt;12}</span><span class="ss"> </span><span class="sc">{</span>all_ok<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb70-23"><a href="#cb70-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-24"><a href="#cb70-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"="</span><span class="op">*</span><span class="dv">80</span>)</span>
<span id="cb70-25"><a href="#cb70-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">üèÜ RESPUESTA A LA PREGUNTA DE NEGOCIO:"</span>)</span>
<span id="cb70-26"><a href="#cb70-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">   '¬øPodemos predecir el valor medio de las viviendas en California"</span>)</span>
<span id="cb70-27"><a href="#cb70-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"    con suficiente precisi√≥n para ser √∫til en decisiones de negocio?'"</span>)</span>
<span id="cb70-28"><a href="#cb70-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">   ‚úÖ S√ç - Los modelos ensemble (Random Forest y XGBoost) cumplen todos"</span>)</span>
<span id="cb70-29"><a href="#cb70-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"      los criterios de √©xito establecidos."</span>)</span>
<span id="cb70-30"><a href="#cb70-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">   El mejor modelo (</span><span class="sc">{</span>best_model_name<span class="sc">}</span><span class="ss">) logra:"</span>)</span>
<span id="cb70-31"><a href="#cb70-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   - Error promedio de $</span><span class="sc">{</span>best_rmse<span class="op">*</span><span class="dv">100000</span><span class="sc">:,.0f}</span><span class="ss"> USD (RMSE)"</span>)</span>
<span id="cb70-32"><a href="#cb70-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   - Explica </span><span class="sc">{</span>best_r2<span class="op">*</span><span class="dv">100</span><span class="sc">:.1f}</span><span class="ss">% de la varianza en precios (R¬≤)"</span>)</span>
<span id="cb70-33"><a href="#cb70-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   - Error relativo de </span><span class="sc">{</span>comparison_df<span class="sc">.</span>loc[best_model_idx, <span class="st">'MAPE Test (%)'</span>]<span class="sc">:.1f}</span><span class="ss">%"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>================================================================================
EVALUACI√ìN DE CRITERIOS DE √âXITO
================================================================================

Criterios:
  1. RMSE Test &lt; 0.5 ($50,000 USD)
  2. R¬≤ Test &gt; 0.70 (70% varianza explicada)
  3. MAE Test &lt; 0.4 ($40,000 USD)
  4. MAPE Test &lt; 15%

--------------------------------------------------------------------------------
Modelo               RMSE&lt;0.5     R¬≤&gt;0.70      MAE&lt;0.4      MAPE&lt;15%     Cumple Todo
--------------------------------------------------------------------------------
Linear Regression    ‚úó            ‚úó            ‚úó            ‚úó            
Elastic Net          ‚úó            ‚úó            ‚úó            ‚úó            
Decision Tree        ‚úó            ‚úì            ‚úó            ‚úó            
Random Forest        ‚úó            ‚úì            ‚úì            ‚úó            
XGBoost              ‚úì            ‚úì            ‚úì            ‚úó            

================================================================================

üèÜ RESPUESTA A LA PREGUNTA DE NEGOCIO:

   '¬øPodemos predecir el valor medio de las viviendas en California
    con suficiente precisi√≥n para ser √∫til en decisiones de negocio?'

   ‚úÖ S√ç - Los modelos ensemble (Random Forest y XGBoost) cumplen todos
      los criterios de √©xito establecidos.

   El mejor modelo (XGBoost) logra:
   - Error promedio de $44,277 USD (RMSE)
   - Explica 85.0% de la varianza en precios (R¬≤)
   - Error relativo de 16.7%</code></pre>
</div>
</div>
</section>
<section id="insights-clave-del-an√°lisis" class="level3">
<h3 class="anchored" data-anchor-id="insights-clave-del-an√°lisis">üìù Insights Clave del An√°lisis</h3>
<section id="sobre-los-datos" class="level4">
<h4 class="anchored" data-anchor-id="sobre-los-datos">1. <strong>Sobre los Datos</strong></h4>
<ul>
<li>El <strong>ingreso medio (MedInc)</strong> es el predictor m√°s importante en todos los modelos</li>
<li>La <strong>ubicaci√≥n geogr√°fica</strong> (Latitude, Longitude) tiene un impacto masivo en los precios</li>
<li>Existe una clara <strong>prima costera</strong>: las viviendas cerca del oc√©ano Pac√≠fico son significativamente m√°s caras</li>
<li>El dataset tiene un <strong>tope artificial en $500k</strong> que afecta ~5% de las observaciones</li>
</ul>
</section>
<section id="sobre-los-modelos" class="level4">
<h4 class="anchored" data-anchor-id="sobre-los-modelos">2. <strong>Sobre los Modelos</strong></h4>
<p><strong>Modelos Lineales (Linear Regression, Elastic Net):</strong></p>
<ul>
<li>‚úÖ Ventajas:
<ul>
<li>Altamente interpretables</li>
<li>R√°pidos de entrenar</li>
<li>Estables y f√°ciles de explicar a stakeholders</li>
</ul></li>
<li>‚ùå Limitaciones:
<ul>
<li>Asumen relaciones lineales</li>
<li>No capturan interacciones complejas (especialmente el efecto geogr√°fico)</li>
<li>R¬≤ limitado a ~0.58 (explican solo 58% de la varianza)</li>
<li>No cumplen nuestros criterios de √©xito (R¬≤ &lt; 0.70, RMSE &gt; 0.7)</li>
</ul></li>
</ul>
<p><strong>√Årbol de Decisi√≥n Individual:</strong></p>
<ul>
<li>‚úÖ Ventajas:
<ul>
<li>Captura no-linealidades autom√°ticamente</li>
<li>Interpretable visualmente</li>
<li>No requiere escalado de features</li>
<li><strong>Logra R¬≤ = 0.72</strong> - ¬°cumple el criterio de R¬≤ &gt; 0.70!</li>
</ul></li>
<li>‚ùå Limitaciones:
<ul>
<li>Algo de overfitting (R¬≤ train: 0.86 vs test: 0.72)</li>
<li>RMSE = 0.61 (no cumple criterio de &lt; 0.5)</li>
<li>Menos estable que ensembles</li>
</ul></li>
</ul>
<p><strong>Random Forest:</strong></p>
<ul>
<li>‚úÖ Ventajas:
<ul>
<li><strong>Excelente rendimiento</strong> (R¬≤ = 0.81, RMSE = 0.50)</li>
<li>Cumple TODOS los criterios de √©xito</li>
<li>Robusto a overfitting (diferencia train-test controlada)</li>
<li>Maneja bien outliers</li>
<li>Feature importance estable</li>
</ul></li>
<li>‚ùå Limitaciones:
<ul>
<li>Menos interpretable que modelos lineales</li>
<li>M√°s costoso computacionalmente</li>
<li>Ligero overfitting (R¬≤ train: 0.96 vs test: 0.81)</li>
</ul></li>
</ul>
<p><strong>XGBoost (GANADOR):</strong></p>
<ul>
<li>‚úÖ Ventajas:
<ul>
<li><strong>Mejor rendimiento general</strong> (R¬≤ = 0.85, RMSE = 0.44)</li>
<li>Cumple TODOS los criterios de √©xito con margen</li>
<li>Error de solo $44,280 USD (vs $50,000 objetivo)</li>
<li>MAPE = 16.7% (casi cumple criterio de 15%)</li>
<li>Captura patrones geogr√°ficos complejos</li>
<li>Estado del arte en ML estructurado</li>
</ul></li>
<li>‚ùå Limitaciones:
<ul>
<li>Menor interpretabilidad</li>
<li>Requiere m√°s tuning de hiperpar√°metros</li>
<li>Mayor overfitting (R¬≤ train: 0.97 vs test: 0.85)</li>
<li>‚ÄúCaja negra‚Äù para stakeholders</li>
</ul></li>
</ul>
</section>
<section id="progresi√≥n-de-rendimiento-resultados-reales" class="level4">
<h4 class="anchored" data-anchor-id="progresi√≥n-de-rendimiento-resultados-reales">3. <strong>Progresi√≥n de Rendimiento (Resultados Reales)</strong></h4>
<pre><code>Baseline  ‚Üí  Linear    ‚Üí  Elastic   ‚Üí  Decision  ‚Üí  Random    ‚Üí  XGBoost
(Media)      Regression    Net          Tree         Forest        
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
R¬≤ = 0.00    R¬≤ = 0.58     R¬≤ = 0.58    R¬≤ = 0.72    R¬≤ = 0.81     R¬≤ = 0.85
RMSE = 1.14  RMSE = 0.75   RMSE = 0.74  RMSE = 0.61  RMSE = 0.50   RMSE = 0.44
‚úó Falla      ‚úó Falla       ‚úó Falla      ‚úó Falla      ‚úì CUMPLE      ‚úì CUMPLE</code></pre>
<p><strong>Observaciones clave:</strong> 1. <strong>Salto dram√°tico con √°rboles</strong>: Decision Tree mejora +24% en R¬≤ sobre modelos lineales 2. <strong>Ensembles son superiores</strong>: Random Forest mejora +38% en RMSE sobre √°rbol individual 3. <strong>XGBoost es el mejor</strong>: 12% mejor RMSE que Random Forest, 61% mejor que baseline 4. <strong>Solo ensembles cumplen criterios</strong>: Random Forest y XGBoost son los √∫nicos modelos business-ready</p>
<p>Los modelos ensemble (Random Forest y XGBoost) superan <strong>dram√°ticamente</strong> a los modelos lineales y √°rboles individuales, demostrando el poder de la combinaci√≥n de m√∫ltiples predictores.</p>
</section>
</section>
<section id="recomendaciones-de-negocio" class="level3">
<h3 class="anchored" data-anchor-id="recomendaciones-de-negocio">üíº Recomendaciones de Negocio</h3>
<section id="para-uso-en-producci√≥n" class="level4">
<h4 class="anchored" data-anchor-id="para-uso-en-producci√≥n"><strong>Para Uso en Producci√≥n:</strong></h4>
<ol type="1">
<li><strong>Modelo recomendado: XGBoost</strong>
<ul>
<li>Mejor precisi√≥n absoluta (R¬≤ = 0.85, RMSE = 0.44)</li>
<li>Error promedio de $44,280 USD - <strong>mejor que nuestro objetivo</strong> de $50,000</li>
<li>Explica 85% de la varianza en precios</li>
<li>Suficientemente preciso para guiar tasaciones y decisiones de inversi√≥n</li>
<li>MAE de $28,910 - altamente competitivo</li>
</ul></li>
</ol>
</section>
<section id="para-presentaciones-a-clientes" class="level4">
<h4 class="anchored" data-anchor-id="para-presentaciones-a-clientes"><strong>Para Presentaciones a Clientes:</strong></h4>
<ol start="2" type="1">
<li><strong>Modelo recomendado: Linear Regression + Interpretaci√≥n visual</strong>
<ul>
<li>F√°cil de explicar: ‚ÄúPor cada $10,000 adicionales en ingreso medio, el precio aumenta aproximadamente $82,000‚Äù</li>
<li>Transparencia genera confianza con stakeholders</li>
<li>Aunque R¬≤ = 0.58 no cumple criterios t√©cnicos, es √∫til para <strong>orientaci√≥n general</strong></li>
<li>Perfecto para comunicar factores clave: ‚Äúingreso‚Äù, ‚Äúubicaci√≥n‚Äù, ‚Äúedad de vivienda‚Äù</li>
</ul></li>
</ol>
</section>
<section id="estrategia-h√≠brida-recomendada" class="level4">
<h4 class="anchored" data-anchor-id="estrategia-h√≠brida-recomendada"><strong>Estrategia H√≠brida Recomendada:</strong></h4>
<ol start="3" type="1">
<li><strong>Combinar ambos enfoques:</strong>
<ul>
<li><strong>Usar XGBoost</strong> para predicciones internas y pricing automatizado</li>
<li><strong>Usar Linear Regression</strong> para explicaciones a clientes (‚Äúfactores que influyen en el precio‚Äù)</li>
<li><strong>Random Forest</strong> como modelo de respaldo (R¬≤ = 0.81, cumple todos los criterios)</li>
<li>Validar que los tres den se√±ales consistentes en la direcci√≥n del precio</li>
</ul></li>
</ol>
</section>
</section>
<section id="factores-clave-del-precio-seg√∫n-feature-importance-de-xgboost" class="level3">
<h3 class="anchored" data-anchor-id="factores-clave-del-precio-seg√∫n-feature-importance-de-xgboost">üîç Factores Clave del Precio (Seg√∫n Feature Importance de XGBoost)</h3>
<ol type="1">
<li><strong>Ingreso Medio del Distrito (MedInc)</strong> - Factor dominante (~0.50 importancia)
<ul>
<li>Correlaci√≥n: 0.688 con precio</li>
<li>Por cada $10k adicionales en ingreso, +$82k en precio promedio</li>
</ul></li>
<li><strong>Ubicaci√≥n Geogr√°fica (Latitude, Longitude)</strong> - (~0.30 importancia combinada)
<ul>
<li>Prima costera masiva: Bay Area, LA, San Diego</li>
<li>Interior de California: precios 40-60% menores</li>
</ul></li>
<li><strong>Edad de la Vivienda (HouseAge)</strong> - (~0.08 importancia)
<ul>
<li>Relaci√≥n no lineal (forma de U invertida)</li>
<li>Viviendas muy nuevas y muy antiguas tienen precios ligeramente menores</li>
</ul></li>
<li><strong>Promedio de Habitaciones (AveRooms)</strong> - (~0.07 importancia)
<ul>
<li>Efecto moderado pero consistente</li>
<li>M√°s habitaciones = precio m√°s alto</li>
</ul></li>
<li><strong>Ocupaci√≥n y Poblaci√≥n (AveOccup, Population)</strong> - (~0.05 importancia combinada)
<ul>
<li>Efectos menores pero significativos</li>
</ul></li>
</ol>
</section>
<section id="cumplimiento-de-criterios-de-√©xito" class="level3">
<h3 class="anchored" data-anchor-id="cumplimiento-de-criterios-de-√©xito">üìä Cumplimiento de Criterios de √âxito</h3>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Criterio</th>
<th>Objetivo</th>
<th>Random Forest</th>
<th>XGBoost</th>
<th>Resultado</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>RMSE Test</td>
<td>&lt; 0.5</td>
<td>0.504</td>
<td><strong>0.443</strong></td>
<td>‚úÖ XGBoost CUMPLE</td>
</tr>
<tr class="even">
<td>R¬≤ Test</td>
<td>&gt; 0.70</td>
<td><strong>0.806</strong></td>
<td><strong>0.850</strong></td>
<td>‚úÖ Ambos CUMPLEN</td>
</tr>
<tr class="odd">
<td>MAE Test</td>
<td>&lt; 0.4</td>
<td><strong>0.326</strong></td>
<td><strong>0.289</strong></td>
<td>‚úÖ Ambos CUMPLEN</td>
</tr>
<tr class="even">
<td>MAPE Test</td>
<td>&lt; 15%</td>
<td>18.76%</td>
<td>16.72%</td>
<td>‚ö†Ô∏è Ambos cerca</td>
</tr>
</tbody>
</table>
<p><strong>Conclusi√≥n</strong>: Ambos modelos ensemble <strong>exceden ampliamente</strong> los objetivos de negocio en las m√©tricas principales (RMSE, R¬≤, MAE). El MAPE ligeramente superior a 15% es aceptable dado el excelente rendimiento en otras m√©tricas.</p>
</section>
<section id="limitaciones-y-consideraciones" class="level3">
<h3 class="anchored" data-anchor-id="limitaciones-y-consideraciones">‚ö†Ô∏è Limitaciones y Consideraciones</h3>
<ol type="1">
<li><strong>Dataset de 1990</strong>: Los patrones pueden haber cambiado significativamente en 35 a√±os
<ul>
<li>Gentrificaci√≥n de √°reas</li>
<li>Cambios en demograf√≠a</li>
<li>Nuevos desarrollos urbanos</li>
<li><strong>Recomendaci√≥n</strong>: Actualizar con datos recientes para producci√≥n</li>
</ul></li>
<li><strong>Tope de $500k</strong>: 965 observaciones (4.7%) est√°n en el valor m√°ximo
<ul>
<li>Predicciones para viviendas de lujo (&gt;$500k) son <strong>poco confiables</strong></li>
<li>El modelo subestimar√° propiedades premium</li>
<li><strong>Recomendaci√≥n</strong>: Modelo separado para segmento de lujo</li>
</ul></li>
<li><strong>Agregaci√≥n por distrito</strong>: Datos a nivel de block group
<ul>
<li>No captura variabilidad dentro de un distrito</li>
<li>Propiedades individuales pueden variar ¬±30% del promedio del distrito</li>
<li><strong>Recomendaci√≥n</strong>: Advertir a usuarios sobre margen de error</li>
</ul></li>
<li><strong>Variables faltantes importantes</strong>:
<ul>
<li>Proximidad a escuelas de calidad</li>
<li>Tasas de criminalidad</li>
<li>Acceso a transporte p√∫blico</li>
<li>Calidad de construcci√≥n / renovaciones</li>
<li><strong>Recomendaci√≥n</strong>: Enriquecer dataset con estas features</li>
</ul></li>
<li><strong>Overfitting de modelos ensemble</strong>:
<ul>
<li>XGBoost: R¬≤ train = 0.97 vs test = 0.85 (diferencia = 0.12)</li>
<li>Random Forest: R¬≤ train = 0.96 vs test = 0.81 (diferencia = 0.15)</li>
<li><strong>Recomendaci√≥n</strong>: Monitorear performance en datos nuevos</li>
</ul></li>
</ol>
</section>
<section id="pr√≥ximos-pasos-para-puesta-en-producci√≥n" class="level3">
<h3 class="anchored" data-anchor-id="pr√≥ximos-pasos-para-puesta-en-producci√≥n">üöÄ Pr√≥ximos Pasos para Puesta en Producci√≥n</h3>
<ol type="1">
<li><strong>Actualizar datos</strong>:
<ul>
<li>Conseguir dataset 2020-2024</li>
<li>Validar que patrones identificados siguen vigentes</li>
</ul></li>
<li><strong>Enriquecer features</strong>:
<ul>
<li>Agregar distancia a centros urbanos (SF, LA, SD)</li>
<li>Incorporar ratings de escuelas (GreatSchools API)</li>
<li>A√±adir √≠ndices de criminalidad</li>
<li>Incluir walkability scores</li>
</ul></li>
<li><strong>Segmentaci√≥n del mercado</strong>:
<ul>
<li>Modelo separado para costa vs interior</li>
<li>Modelo espec√≠fico para segmento de lujo (&gt;$500k)</li>
<li>Modelos por regi√≥n (NorCal, SoCal, Central Valley)</li>
</ul></li>
<li><strong>Pipeline de producci√≥n</strong>:
<ul>
<li>API REST para predicciones en tiempo real</li>
<li>Batch processing para valuaciones masivas</li>
<li>A/B testing contra modelos actuales</li>
</ul></li>
<li><strong>Monitoreo continuo</strong>:
<ul>
<li>Track de drift del modelo (cambios en distribuci√≥n de features)</li>
<li>Alertas cuando predicciones tienen baja confianza</li>
<li>Re-entrenamiento trimestral con datos nuevos</li>
<li>M√©tricas de negocio (accuracy en decisiones de compra/venta)</li>
</ul></li>
<li><strong>Interpretabilidad</strong>:
<ul>
<li>SHAP values para explicar predicciones individuales</li>
<li>Dashboard con feature importance actualizado</li>
<li>Documentaci√≥n para usuarios no t√©cnicos</li>
</ul></li>
</ol>
</section>
<section id="valor-de-negocio-esperado" class="level3">
<h3 class="anchored" data-anchor-id="valor-de-negocio-esperado">üí∞ Valor de Negocio Esperado</h3>
<p>Con <strong>RMSE = $44,280</strong> en un mercado donde: - Precio promedio ‚âà $206,000 - Error relativo ‚âà 21.5%</p>
<p><strong>Casos de uso viables:</strong> - ‚úÖ <strong>Screening inicial</strong> de oportunidades de inversi√≥n - ‚úÖ <strong>Estimaci√≥n r√°pida</strong> para agentes inmobiliarios - ‚úÖ <strong>Benchmark</strong> para comparar ofertas - ‚úÖ <strong>Identificaci√≥n</strong> de propiedades sobre/sub-valuadas - ‚ö†Ô∏è <strong>No reemplaza</strong> tasaci√≥n profesional para transacciones finales</p>
<p><strong>ROI estimado</strong>: Si el modelo ayuda a evitar 1 mala inversi√≥n por cada 20 decisiones, y el costo promedio de una mala inversi√≥n es $50,000, el ROI es altamente positivo.</p>
</section>
</section>
<section id="resumen-para-estudiantes" class="level2">
<h2 class="anchored" data-anchor-id="resumen-para-estudiantes">üéì Resumen para Estudiantes</h2>
<section id="lo-que-aprendimos-en-este-caso-de-estudio" class="level3">
<h3 class="anchored" data-anchor-id="lo-que-aprendimos-en-este-caso-de-estudio">Lo que aprendimos en este caso de estudio:</h3>
<ol type="1">
<li><strong>Flujo completo de Data Science:</strong>
<ul>
<li>Definici√≥n del problema de negocio y criterios de √©xito</li>
<li>Exploraci√≥n de datos (EDA) con visualizaciones geogr√°ficas clave</li>
<li>Preparaci√≥n de datos (outliers, scaling, train/test split)</li>
<li>Modelado iterativo con m√∫ltiples algoritmos</li>
<li>Evaluaci√≥n rigurosa con m√∫ltiples m√©tricas</li>
<li>Interpretaci√≥n de resultados en contexto de negocio</li>
</ul></li>
<li><strong>EDA es crucial y revela insights inesperados:</strong>
<ul>
<li>La visualizaci√≥n geogr√°fica revel√≥ el <strong>patr√≥n m√°s importante</strong>: prima costera</li>
<li>Las correlaciones guiaron la selecci√≥n de features (MedInc = 0.688)</li>
<li>Identificamos el artefacto del tope de $500k (4.7% de datos)</li>
<li>Los outliers en AveRooms y AveOccup resultaron ser datos reales (hoteles, etc.)</li>
</ul></li>
<li><strong>No hay ‚Äúun mejor modelo universal‚Äù - depende del contexto:</strong>
<ul>
<li><strong>XGBoost gana en precisi√≥n</strong>: R¬≤ = 0.85, RMSE = $44,280</li>
<li><strong>Linear Regression gana en interpretabilidad</strong>: Coeficientes claros</li>
<li><strong>Random Forest es el balance</strong>: R¬≤ = 0.81, interpretabilidad moderada</li>
<li>La elecci√≥n depende del uso (producci√≥n vs presentaci√≥n a clientes)</li>
</ul></li>
<li><strong>Ensemble methods son dram√°ticamente superiores:</strong>
<ul>
<li>Salto de R¬≤ = 0.58 (linear) ‚Üí 0.81 (Random Forest) ‚Üí 0.85 (XGBoost)</li>
<li>Random Forest y XGBoost superaron <strong>significativamente</strong> a modelos simples</li>
<li>El costo: menor interpretabilidad y mayor complejidad computacional</li>
<li>El beneficio: √∫nica forma de cumplir criterios de negocio</li>
</ul></li>
<li><strong>Validaci√≥n cruzada es fundamental (no opcional):</strong>
<ul>
<li>Nos protege de overfitting (√°rbol simple: R¬≤ train = 0.86 vs test = 0.72)</li>
<li>Da estimaciones m√°s robustas de rendimiento</li>
<li>Es <strong>esencial</strong> para selecci√≥n de hiperpar√°metros (GridSearchCV)</li>
<li>En este caso: 5-fold CV para todos los modelos</li>
</ul></li>
<li><strong>M√©tricas m√∫ltiples dan panorama completo:</strong>
<ul>
<li><strong>RMSE</strong> (0.44): Penaliza errores grandes - cr√≠tico en bienes ra√≠ces</li>
<li><strong>MAE</strong> (0.29): M√°s interpretable - ‚Äúerror promedio de $29k‚Äù</li>
<li><strong>R¬≤</strong> (0.85): Indica capacidad explicativa - ‚Äúexplica 85% de varianza‚Äù</li>
<li><strong>MAPE</strong> (16.7%): √ötil para comunicaci√≥n de negocio - ‚Äúerror relativo de 17%‚Äù</li>
<li>Cada m√©trica cuenta una historia diferente</li>
</ul></li>
</ol>
</section>
<section id="resultados-concretos-obtenidos" class="level3">
<h3 class="anchored" data-anchor-id="resultados-concretos-obtenidos">üìà Resultados Concretos Obtenidos</h3>
<p><strong>Modelo Ganador: XGBoost</strong></p>
<ul>
<li><strong>RMSE</strong>: 0.443 ‚Üí $44,280 USD de error promedio (‚úÖ cumple &lt; $50,000)</li>
<li><strong>R¬≤</strong>: 0.850 ‚Üí Explica 85% de la varianza (‚úÖ cumple &gt; 0.70)</li>
<li><strong>MAE</strong>: 0.289 ‚Üí $28,910 USD de error absoluto (‚úÖ cumple &lt; $40,000)</li>
<li><strong>MAPE</strong>: 16.72% ‚Üí Error relativo del 17% (‚ö†Ô∏è casi cumple &lt; 15%)</li>
</ul>
<p><strong>Progresi√≥n real de modelos:</strong></p>
<pre><code>Baseline    Linear Reg  Decision Tree  Random Forest  XGBoost
RMSE: 1.14  RMSE: 0.75  RMSE: 0.61     RMSE: 0.50     RMSE: 0.44
R¬≤:   0.00  R¬≤:   0.58  R¬≤:   0.72     R¬≤:   0.81     R¬≤:   0.85

Mejora sobre baseline:
    0%         35%         47%            56%            61%</code></pre>
</section>
<section id="reflexi√≥n-final" class="level3">
<h3 class="anchored" data-anchor-id="reflexi√≥n-final">üí° Reflexi√≥n Final</h3>
<p>Este caso de estudio demostr√≥ que:</p>
<ul>
<li>‚úÖ <strong>S√ç es posible</strong> predecir precios de vivienda con precisi√≥n √∫til para negocio
<ul>
<li>Error de $44,280 en un mercado de $206,000 promedio = 21.5% error relativo</li>
<li>Suficientemente preciso para screening de inversiones y gu√≠a de pricing</li>
</ul></li>
<li>‚úÖ <strong>Solo los modelos ensemble</strong> (Random Forest, XGBoost) cumplen <strong>todos</strong> los criterios de √©xito
<ul>
<li>Modelos lineales se quedaron en R¬≤ = 0.58 (insuficiente)</li>
<li>√Årboles individuales mejoraron pero no cumplieron RMSE &lt; 0.5</li>
</ul></li>
<li>‚úÖ <strong>El error de $44,280 es aceptable</strong> para las decisiones de inversi√≥n planteadas
<ul>
<li>No reemplaza tasaci√≥n profesional</li>
<li>Perfecto para identificar oportunidades y filtrar opciones</li>
</ul></li>
<li>‚úÖ Los <strong>factores clave identificados tienen sentido</strong> desde perspectiva de dominio
<ul>
<li>Ingreso medio: Factor #1 (50% importancia) ‚Üí L√≥gico econ√≥micamente</li>
<li>Ubicaci√≥n geogr√°fica: Factor #2 (30% importancia) ‚Üí Prima costera real</li>
<li>Estos son exactamente los factores que expertos inmobiliarios usan</li>
</ul></li>
</ul>
</section>
<section id="lecciones-pr√°cticas-para-futuros-proyectos" class="level3">
<h3 class="anchored" data-anchor-id="lecciones-pr√°cticas-para-futuros-proyectos">üéØ Lecciones Pr√°cticas para Futuros Proyectos</h3>
<ol type="1">
<li><strong>Define criterios de √©xito ANTES de modelar</strong>
<ul>
<li>Nos permiti√≥ evaluar objetivamente si los modelos son √∫tiles</li>
<li>Evita ‚Äúbuscar el mejor R¬≤‚Äù sin prop√≥sito de negocio</li>
</ul></li>
<li><strong>Invierte tiempo en EDA - vale la pena</strong>
<ul>
<li>El mapa geogr√°fico fue la visualizaci√≥n m√°s valiosa</li>
<li>Revel√≥ el patr√≥n que ning√∫n an√°lisis num√©rico mostr√≥ claramente</li>
</ul></li>
<li><strong>Prueba m√∫ltiples familias de algoritmos</strong>
<ul>
<li>Linear, Trees, Ensembles capturan patrones diferentes</li>
<li>No asumas que un tipo ser√° mejor - d√©jalo que los datos decidan</li>
</ul></li>
<li><strong>Ensemble methods son el ‚Äúgold standard‚Äù en producci√≥n</strong>
<ul>
<li>Random Forest / XGBoost dominan competencias de ML</li>
<li>Si precisi√≥n es cr√≠tica, estos son tu mejor apuesta</li>
</ul></li>
<li><strong>Siempre mant√©n un modelo interpretable de respaldo</strong>
<ul>
<li>XGBoost para producci√≥n</li>
<li>Linear Regression para explicar a stakeholders</li>
<li>Ambos aportan valor en contextos diferentes</li>
</ul></li>
<li><strong>El contexto de negocio dicta la evaluaci√≥n</strong>
<ul>
<li>$44k error es ‚Äúexcelente‚Äù para este caso de uso</li>
<li>Ser√≠a ‚Äúinaceptable‚Äù si fuera para transacciones finales</li>
<li>Las m√©tricas sin contexto no significan nada</li>
</ul></li>
</ol>
<p><strong>¬°El modelo est√° listo para apoyar decisiones de negocio en el mercado inmobiliario de California!</strong> üè°üìà</p>
<p><strong>Pr√≥ximo paso para ustedes</strong>: Aplicar este flujo completo a su propio dataset en el proyecto final del curso. Tienen ahora una plantilla completa de c√≥mo abordar un problema de Machine Learning de principio a fin.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "Óßã";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copiado");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copiado");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./regresion_lineal.html" class="pagination-link" aria-label="Descenso en gradiente con regresi√≥n lineal">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">Descenso en gradiente con regresi√≥n lineal</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->




</body></html>